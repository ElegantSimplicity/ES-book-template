\chapter{Stable and unstable manifolds}


In this chapter, we want to address some of the natural questions that came up when discussing some examples.
Two important questions: `Can we attach handles in a different order' and `Can we find an isotopy that cancels two critical points'?
To answer these questions, we introduce the concept of stable and unstable manifolds.
\todo{They will allow us see handles not only as a local phenomenon but also how they interact.}

\section{Stable and unstable manifolds}


\begin{definition}
    Let $p$ be a critical point of a morse function $f$.
    Denote by $\psi^{t}$ the flow of a pseudo-gradient.
    Then the unstable manifold is defined as
    \[
        \unstable{p} = \big\{x \in M  \mid  \lim_{t \to -\infty} \psi^{t} (x)  = p\big\} 
    ,\] 
    and its stable manifold is defined as
    \[
        \stable{p} = \big\{x \in M  \mid  \lim_{t \to \infty} \psi^{t} (x)  = p\big\} 
    ,\] 
\end{definition}
\begin{marginfigure}
    \centering
    \incfig{stable-and-unstable-manifolds-are-manifiolds}
    \caption{Locally in a Morse chart, stable and unstable manifolds are given by the horizontal and vertical axis, i.e.\ $ x_1= \cdots= x_k = 0$ and $x_{k+1}= \cdots= x_n = 0$.}
    \label{fig:stable-and-unstable-manifolds-are-manifiolds}
\end{marginfigure}
Let us first verify that these objects are indeed manifolds. 
Around a critical point $p$, the unstable manifold $\unstable{p}$ is in a Morse chart $U$ given by $x_{k+1} = \cdots = x_n = 0$, so it is diffeomorphic to $\odisk{k}$.
The points in $\unstable{p}$ that lie outside $U$ can then be obtained by flowing the boundary of $\odisk{k}$ along the pseudo-gradient, which is diffeomorphic to $\sphere{k-1} \times \R$. All in all, when gluing this to $\odisk{k}$, we end up with something that is indeed a manifold, and diffeomorphic to $\odisk{k}$.
A similar reasoning for the stable manifold shows that $\stable{p} \cong \odisk{n - k}$.
We have obtained the following result:

\begin{prop}
    Stable and unstable manifolds of a critical points are submanifolds diffeomorphic to open disks. Moreover,
    \[
        \dim \unstable{p} = \codim \stable{p} = \Ind p
    .\] 
\end{prop}

\todo{Here $\odisk{k}$ is an open disk, earlier $\cdisk{1} = [-1, 1]$ was used as closed? Fix this!}

\begin{eg}
    Let us consider $T^{2}$ embedded in $\R^3$ in the standard way and consider the height function. 
    This function has $4$ critical points and is clearly Morse.
    Let $X = \grad f$ be the gradient of $f$ w.r.t.\ standard metric on $\R^{3}$.
    Then the stable and unstable manifolds of $X$ are illustrated in Figure~\ref{fig:torus-height-function-stable-and-unstable-manifolds}.
    \label{eg:torus-stable-unstable-manifolds-standard-gradient}
\end{eg}
    \begin{figure}[H]
        \centering
        \incfig{torus-height-function-stable-and-unstable-manifolds}
        \caption{
        Stable and unstable manifolds for all critical points of the height function on the torus with the standard gradient on $\R^3$.
    All of them are diffeomorphic to either $\odisk{2}$, $\odisk{1}$ or  $\odisk{0}$.
    Note that $\stable{b}$ and  $\unstable{c}$ do not intersect transversally.
}
        \label{fig:torus-height-function-stable-and-unstable-manifolds}
    \end{figure}

    \begin{figure}[H]
        \centering
        \incfig{other-sphere-definition-of-mathcal-m}
        \caption{
            Stable and unstable manifolds of the other sphere with standard gradient on $\R^3$.  Note that all of them intersect transversally.
        }
        \label{fig:other-sphere-definition-of-mathcal-m}
    \end{figure}


    \begin{marginfigure}
        \centering
        \incfig{when-can-we-attach-multiple-handles-at-the-same-time}
        \caption{
            A cobordism from $S^{1}$ to $S^{1} \sqcup S^1 \sqcup S^1$.
            Stable and unstable manifolds do not intersect, which implies we can reorder the critical points $p$ and $q$.
        }
        \label{fig:when-can-we-attach-multiple-handles-at-the-same-time}
    \end{marginfigure}
    The stable and unstable manifolds give us information about interaction of handles.
    For example, consider the situation in Figure~\ref{fig:when-can-we-attach-multiple-handles-at-the-same-time}.
    Here, we can flow the two handle structures to the bottom without intersecting, which implies we can attach the two handles at the same time, i.e.\ one is not dependent on the other.
    Here, `flowing of handle structures' means flowing along unstable manifolds.
    An obtrusion to attaching two handles at the same time would then be the intersection of stable and unstable manifolds. We will make this more precise later.
    \section{Intersections of stable and unstable manifolds}
    %TODO: figure.
    %TODO: check for use of descending/ascending.
    Let us now investigate the condition under which stable and unstable manifolds do not intersect.
    Suppose $p$ and $q$ are two critical points of a Morse function $f: M \to  \R$.
    Let's consider $\stable{p} \cap \unstable{q}$.
    If $f(p) > f(q)$, then  $\stable{p} \cap \unstable{q} = \O$, because $f(\stable{p}) > f(\unstable{q})$.
    What can we say if $f(p) \le  f(q)$?
    If we assume that the intersection is transverse, Proposition~\ref{prop:transverse-codimensions-add} implies that the codimensions add in the following sense:
    \[
        \codim(\stable{p} \tcap  \unstable{q}) = \codim \stable p + \codim \unstable q
    ,\] 
    so we have
    \[
        \dim \stable p \tcap \unstable q = \Ind q - \Ind p
    .\]
    In particular, we have that if $\Ind q < \Ind p$,  $\stable{p} \tcap \unstable{q} = \O$, which will turn out to mean that we can always attach lower index handles before higher index ones.


    This transversality condition has a name:
    \todo{History}
    \begin{definition}[Smale condition]
        A pseudo-gradient field addapted to a Morse function $f$ is said to satisfie the \emph{Smale condition} if all for all pairs of critical points $ \{p, q\}  \subset \Crit f$, we have that $\stable{p}$ intersects  $\unstable{q}$ transversally, i.e. 
        \[
            \stable{q} \tcap  \unstable{p} \text{ for all $p, q \in \Crit f$}
        .\] 
    \end{definition}
    Later we will prove that this condition is not at all restricting: we can always perturbate the pseudo-gradient field such that it satisfies the Smale condition.

    \begin{noneg}
        The gradient vector field in Example~\ref{eg:torus-stable-unstable-manifolds-standard-gradient} does not satisfy the Smale condition: the intersection of $\stable{b}$ and  $\unstable{c}$ is not transverse.
        Even more, if this condition would be true, there should be no trajectories connecting $b$ and $c$, because both have index $1$, so $\dim (\stable{b} \tcap \unstable{c}) = 0$.
    \end{noneg}

    \begin{eg}
        Instead of considering the embedding as in the previous example, we can embed the torus at a slight angle.
        Then the gradient of the height function (by using the standard metric on $\R^3$) does satisfy the Smale condition.
        The intersection of $\stable{b}$ and  $\unstable{c}$ is not tangent any more: indeed, they do not even intersect at all. We have illustrated this in Figure~\ref{fig:torus-height-function-stable-and-unstable-manifolds}.
    \end{eg}
    \begin{eg}
        As illustrated in Figure~\ref{fig:other-sphere-definition-of-mathcal-m}, other sphere with gradient of the height function w.r.t the metric of $\R^3$ does satisfy Smale condition. 
    \end{eg}
\begin{figure}[H]
    \centering
    \incfig{torus-tilted-height-function-stable-and-unstable-manifolds}
    \caption{
        When embedding the torus in $\R^3$ tilted, the Smale condition is satisfied. All stable and unstable manifolds intersect transversally, which per definition also includes not intersecting at all.
    }
    \label{fig:torus-tilted-height-function-stable-and-unstable-manifolds}
\end{figure}

The Smale condition also has another interesting consequence, which we have not touched upon.
If stable and unstable manifolds intersect transversely, we know that the intersection is again a submanifold.
So $\stable{q} \tcap \unstable{p}$ is a manifold for all critical points $p, q \in \Crit f$.
This submanifold contains of all points on the trajectories connecting $p$ to $q$.
 \begin{definition}
    Let $f: M \to  \R$ be a Morse function and $\psi^{t}$ the flow of a pseudo-gradient that satisfies the Smale condition.
    Then we define
    \begin{align*}
        \traj{p}{q} &= \stable{q} \tcap \unstable{p}\\
                    &= \big\{
            x \in M 
            \mid 
            \lim_{t \to -\infty} \psi^{t}(x) = p, \ 
            \lim_{t \to \infty} \psi^{t}(x) = q
        \big\} 
    ,\end{align*} 
    which is a submanifold of dimension $\Ind p - \Ind q$.
\end{definition}

\begin{eg}
    Consider the other sphere. 
    We have illustrated $\traj{p}{q}$ below for some of the critical points of the height function.
    Here we see that these type of submanifolds do not need to be connected. For example, $\traj{b}{a}$ is diffeomorphic to the disjoint union of two open intervals.
\end{eg}

Instead of considering set of points lying on all trajectories from $p$ to $q$, $\traj{p}{q}$, we can also construct a set where each point corresponds to exactly one trajectory.
We do this by modding out $\traj{p}{q}$ by $\R$-action of translations in time. We denote the resulting space with $\L{p}{q}$.
More explicitly, we have the following:

\begin{prop}
    Let $f: M \to  \R$ be a Morse function and $\psi^{t}$ the flow of a pseudo-gradient field satisfying the Smale condition.
    Then group $(\R, +)$ of time translations acts on $\traj{p}{q}$ by  $t \cdot x = \psi^{t}(x)$.  If $p \neq q$ then the action is free and we can define $ \L{p}{q} = \traj{p}{q} / \R $. The dimension of $\L{p}{q}$ is $\Ind p - \Ind q - 1$.
\end{prop}
\begin{proof}
    It is clear that $\R$ acts on $\traj{p}{q}$ by time translations. 
    If $p \neq q$,  $\traj{p}{q}$ does not contain any critical point, so flowing along a pseudo-gradient field, the value of $f$ is strictly decreasing. This proves freeness.
\end{proof}

\begin{remark}
    If the index of two points only differs by one, say $\Ind p = \Ind q + 1$, then the dimension of $\L{p}{q}$ is $0$, so it is a discrete set.
    This proves that the number of trajectories from $p$ to $q$ is always finite, and the number is given by $| \L{p}{q}|$.
    This will be important later when we are dealing with the Morse complex.
\end{remark}
\begin{remark}
    Another way to look at $\L{p}{q}$ is to consider an $a \in \R$ such that $f(p)<a<f(q)$. Then every flow line from $p$ to $q$  intersects $f^{-1}(a)$ exactly once (the value of $f$ is decreasing along the way), so we can identify  $\L{p}{q}$ with  $\traj{p}{q} \cap f^{-1}(a)$.
\end{remark}




\begin{figure}[H]
    \centering
    \incfig{mathcal-m-trajectories-other-sphere}
    \caption{
        Illustration of $\traj{p}{q}$ and $\L{p}{q}$ for critical points of the other sphere.
    }
    \label{fig:mathcal-m-trajectories-other-sphere}
\end{figure}



% \todo{Mention that handles are thickened up descending manifolds.}
\todo{Also give examples in 3 dimensions}


\filbreak
\section{Reordering critical points}
\todo{Theorem of Milnor $h$-cobordism:}
\begin{theorem}
    Let $f: M \to  \R$ be a morse function on a cobordism $M = M_0 \sqcup M_1$ such that $ M_0 = f^{-1}(0)$ and $ M_1 = f^{-1}(1)$ with two critical points $p$ and  $p'$.
    Suppose that for some choice of pseudo-gradient field $X$, the stable and unstable manifolds do not intersect.
    Let $a, a' \in (0,1)$ be arbitrary.
    Then there exists a new Morse function $g$ such that
    \begin{enumerate}[(a)]
        \item $X$ is a gradient-like vector field for  $g$
        \item The critical points of  $g$ are still $p, p'$ and $g(p) = a$,  $g(p') = a'$.
        \item $g$ agrees with  $f$ near $M_0 \sqcup M_1$ and equals $f$ plus a constant in some neighborhood of  $p$ and some neighborhood of  $p'$.
    \end{enumerate}
\end{theorem}
\begin{marginfigure}
    \centering
    \incfig{reordening-theorem-milnor-h-cobordism}
    \caption{
        Construction of $\overline{\mu}$ and $\pi$ in the proof on reordening critical points.
    }
    \label{fig:reordening-theorem-milnor-h-cobordism}
\end{marginfigure}
\begin{proof}
    We want to mask out the area around the descending and ascending manifold of one of the critical points.
    Let $\mu: M_0 \to  [0,1]$ be a smooth map that is $0$ around  $ M_0 \cap \unstable p$ and $1$ around $M_0 \cap \unstable{p'}$, as illustrated in Figure~\ref{fig:reordening-theorem-milnor-h-cobordism}.
    Then we can smoothly extend this to a function on the whole manifold $M$.
    Define $\pi: M \to  M_0$ by flowing along the pseudo-gradient field until we reach $M_0$.
    Then we can extend $\mu$ uniquely to a smooth function that is constant on each trajectory as follows:
    \begin{align*}
        \overline{\mu}: M &\longrightarrow [0,1] \\
        x &\longmapsto \begin{cases}
            0 & \text{if $x$ in stable or unstable manifold of $p$}\\
            1 & \text{if $x$ in stable or unstable manifold of $p'$}\\ 
            \mu(\pi(x)) & \text{else}
        \end{cases}
    .\end{align*}
    We have illustrated this in the figure by colouring regions where $\mu$ is high with red.

    Define a new Morse function $g: M \to  [0,1]$ by $g(q) = G_{\overline{\mu}(q)}(f(q))$, where $G_{s}(x)$ is a smooth family of smooth functions $G_s: [0,1] \to  [0,1]$ with $s \in [0,1]$ that has the following properties, also indicated in Figure~\ref{fig:proof-reordening-properties-of-g}.
    \begin{marginfigure}
        \centering
        \incfig{proof-reordening-properties-of-g}
        \caption{Necessary properties of $G$ in the proof on reordering critical points are indicated in yellow.}
        \label{fig:proof-reordening-properties-of-g}
    \end{marginfigure}
    \begin{enumerate}[(1)]
        \item For all $s$, $G_s' > 0$ and $G_s$ increases from $0$ to  $1$ as $x$ increases from  $0$ to  $1$
        \item  $G_0(f(p)) = a$\\ $G_1(f(p')) = a'$
        \item  $G_s(x) = x$ for $x$ near  $0$ or  $1$ and for all $s$ 
        \item  $G_0'(x) = 1$ for $x$  in a neighborhood of $f(p)$\\
        $G_1'(x) = 1$ for $x$  in a neighborhood of $f(p')$
    \end{enumerate}
    Property (b) and (c) are clear: they follow immediately from (2), (3) and (4).
    For (a), consider
    \[
        dG(\overline{\mu}, f) = \frac{\partial G}{\partial \overline{\mu}}  d\overline{\mu} + \frac{\partial G}{\partial f}  df
    .\] 
    Plugging in $X$, we have
    \begin{align*}
        dg(X) &= \frac{\partial G}{\partial \overline{\mu}}  d\overline{\mu}(X) + \frac{\partial G}{\partial f}  df(X)\\
              &= \frac{\partial G}{\partial f}  df(X) < 0 \text{, except at critical points of $f$}
    ,\end{align*} 
    where we used that $d\overline{\mu}(X) = 0$ per construction of $\overline{\mu}$, $\frac{\partial G}{\partial f} > 0$ by (1) and $df(X) < 0$ everywhere except at critical points of $f$ by definition of pseudo-gradient field.
    Because of (4), this implies that $g$ and $f$ share the same behaviour around their critical points, proving that $g$ is also Morse.
\end{proof}

\begin{remark}
    This theorem can be extended to a more general setting. Suppose we have a set of points $\mathbf{p} = \{p_1, \ldots, p_k\}$ and $\mathbf{p}' = \{p_1', \ldots, p_\ell\}$, with all $p_i$ at the same level and all $p_i'$ at a single level.
    Then the theorem remains valid, with exactly the same proof.
\end{remark}

If the pseudogradient vector field $X$ satisfies the Smale condition, then we know the intersection of stable and unstable manifolds very well.
In particular, if $\Ind p \le  \Ind q$, the intersection of $\unstable{p}$ and  $\stable{q}$ is empty.
Applying this reordering theorem multiple times, we have the following

\begin{theorem}
    Any closed manifold admits a Morse function such that for all critical points, $\Ind p < \Ind q \implies f(p) < f(q)$.
    In particular, it admits a Morse function, which satisfies $ \Ind p  = f(p) $ for all critical points $p \in \Crit f$.
\end{theorem}
In other words, this asserts that lower index handles can always be attached before higher index ones.
Morse functions as described in the second part have a name:

\begin{definition}[Self-indexing Morse function]
    A Morse function $f: M \to  \R$is \emph{self-indexing} if $\Ind p = f(p)$ for all critical points  $p$ of  $f$.
\end{definition}


% \section{Smale condition is generic (proof)}
\section{Cancellation of critical points}
\todo{$h$-cobordism Milnor page 37}


\section{Heegaard splittings}

\begin{marginfigure}
    \centering
    \incfig{heegaard-splittings-schemattically}
    \caption{Schematic visualization of a self-indexing Morse function on a $3$-manifold $M$.
        The manifold $S = f^{-1}(\frac{3}{2})$ is called the splitting surface of $M$.
    }
    \label{fig:heegaard-splittings-schemattically}
\end{marginfigure}

As we showed earlier, any $3$-manifold $M$ has a Morse function that is self-indexing, giving rise to a handle decomposition schematically shown in Figure~\ref{fig:heegaard-splittings-schemattically}. When splitting the manifold along $f^{-1}(\frac{3}{2})$, we decompose $M$ in two parts: a part that consists of $0$- and $1$-handles glued along its boundary to a part consisting only of $2$- and  $3$-handles.
However the latter can also be seen as being constructed of $0$- and $1$-handles, simply by building $M$ from top to bottom by considering the Morse function $-f$ instead of $f$. This then interchanges $k$-and $n-k$-handles, or in the case of $n=3$, $2$-handles  become $1$-handles and $3$-handles become $0$-handles.
All things considered, we have a decomposition of $M$ in two so-called handlebodies:
\begin{definition}[Handlebody\sidenotemark]
    A handlebody is a compact connected orientable $3$-manifold with boundary that possesses a handle decomposition consisting of $0$-handles and $1$-handles. The \emph{genus} of a handlebody is the genus of its boundary.
\end{definition}
\begin{definition}[Heegaard splitting\sidenotemark]
    A \emph{Heegaard splitting} of a closed $3$-manifold $M$ is a decomposition $M = V \cup _S W$ such that $V$ and $W$ are handlebodies and  $S = \partial V = \partial W$. Here  $S$ is called the \emph{splitting surface of $M$}.
    Two Heegaard splittings are considered \emph{equivalent} if their splitting surfaces are isotopic. The \emph{genus} of a Heegaard splitting is the genus of $S$.
\end{definition}
\sidenotetext[][-2cm]{\fullcite{schultens2014introduction}}

With these definitions, our findings can be summarized as follows:
\begin{theorem}[Moise \todo{citation}]
    Every closed orientable $3$-manifold admits a Heegaard splitting.
\end{theorem}
\begin{proof}
    Let $f$ be a self-indexing Morse function on $M$.
    Then $M = f^{-1}\left[0, \tfrac{3}{2}\right] \cup f^{-1}\left[\tfrac{3}{2}, 3\right]$ is a Heegaard splitting of $M$ by duality of $k$- and $n-k$-handles.
\end{proof}

\begin{eg}
    As seen earlier, the `height' function on $S^{3}$ gives rise to a handle decomposition $S^{3} = \cdisk{2} \cup \cdisk{2}$. This is a Heegaard splitting of genus $0$ with splitting surface $S^{2}$.
\end{eg}
\begin{eg}
    \begin{marginfigure}
        \centering
        \incfig{genus-four-heegaard-splitting-of-s3}
        \caption{A genus four Heegaard splitting of $S^{3}$, seen as the one point compactification of $\R^3$.
            This way, we can obtain a Heegaard splitting of $S^{3}$ of any genus.
        }
        \label{fig:genus-four-heegaard-splitting-of-s3}
    \end{marginfigure}
    The previous example is not the only way to decompose $S^{3}$.
    Indeed, we can arbitrarily add cancelable $1$- and $2$-handles to increase the genus. 
    For example a genus four Heegaard splitting of $S^{3}$ is illustrated in Figure\ref{fig:genus-four-heegaard-splitting-of-s3}.
    Here, we visualized $S^{3}$ as the one point compactification of $\R^3$.
    \label{eg:s3-heegaard-four-genus}
\end{eg}
\begin{marginfigure}
    \centering
    \incfig{three-torus-heegaard-splitting}
    \caption{
        Illustration of the splitting surface of the Morse function defined earlier.
        Here we identify $T^{3} = \R^3 / \Z^3$ and draw $[0,1]^3$.
        This Heegaard splitting has genus $3$.
    }
    \label{fig:three-torus-heegaard-splitting}
\end{marginfigure}
\begin{eg}
    If we split the handle decomposition of $T^{3}$ given in Example~\ref{eg:handle-decomposition-three-torus} between index $1$ and $2$ critical points, then we find the surface illustrated in Figure~\ref{fig:three-torus-heegaard-splitting}, were we identified $T^{3} = \R^3 / \Z^{3}$.
    We see that the splitting surface has genus three.
\end{eg}

% \subsection{Stabilization and destabilization}

The act of increasing the genus, as done in Example~\ref{eg:s3-heegaard-four-genus} is called stabilization.
It can be done in as in Figure~\ref{fig:stabilization}.

\begin{marginfigure}
    \centering
    \incfig{stabilization}
    \caption{
        The act of stabilization is replacing a ball near the boundary as illustrated, increasing the genus of the splitting surface by one.}
    \label{fig:stabilization}
\end{marginfigure}
