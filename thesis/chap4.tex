\chapter{Applications of Morse homology}
\label{chap:app-morse-homology}

This chapter discusses some applications of Morse homology.
While we already know that it isomorphic to singular homology and hence it enjoys all the same properties, it can still be fruitful to derive these things directly from the definitions of Morse homology.
We will do this for the Poincaré duality and the Künneth formula in the first two sections of this chapter.
The third and last section discusses the Morse inequalities, giving a lower bound for the number of critical points of a Morse function $f: M \to  \R$ based on the homology of $M$.
This relation can also been seen in reverse: the number of critical points of a Morse function give bounds on the homology of $M$.
These inequalities will play a major role in the next chapter.

\section{Poincaré duality}
The Poincaré duality was first stated by Henri Poincaré in his paper `Analysis Situs'.\sidecite{poincare1895analysis}
In this seminal paper, Poincaré introduces furthermore the concepts of fundamental group, simplicial complex, generalized Euler characteristic, founding the field of algebraic topology. Let us state and prove a modern version of Poincaré duality.

\begin{theorem}[Poincaré duality]
    Let $M$ be a compact manifold, and $f: M \to  \R$ a Morse function with adapted pseudo-gradient $X$.
    Then
    \[
        H_k(M; \Z_2) \cong H_{n-k}(M; \Z_2)
    .\]
    Moreover, if $M$ is oriented, then \[
         H_{k}(M; \Z) \cong H^{n-k}(M; \Z)
    .\]
\end{theorem}
\begin{myproof}
    The idea of this proof is to turn the manifold upside down, i.e.\ $f\leadsto -f$.
    Then critical points of index $k$ of $f$  become critical points of index $n-k$ of  $-f$.
    Moreover $-X$ is an adapted pseudo-gradient for $-f$, unstable manifolds of critical points of $f$ become stable manifolds of corresponding critical points of $-f$ and vice versa.
    This immediately gives that $H_k(M; \Z_2) \cong H_{n-k}(M; \Z_2)$.

    Working over $\Z$, things are more subtle.
    In general $H_k(M; \Z) \not \cong H_{n-k}(M; \Z)$.
    The best we can do is saying that if $M$ is orientable, then the ranks of  $H_k(M; \Z)$ and $H_{n-k}(M; \Z)$ agree,
    as is proven in `Morse theory and Floer homology' by Audin and Damian.\sidecite[p~84.]{audin}.

    In order to get a more natural form of Poincaré duality, it is beneficial to consider Morse cohomology, as done in notes by Fushida-Hardy.\sidecite{fushidamorse}
    Recall from Chapter~0 that singular cohomology is defined as the homology of the dual of the singular chain complex, i.e.\ the homology of $C^{k} = \Hom(C_k, \Z)$, with as differential the adjoint of $\partial$. The resulting homology is denoted with $H^{k}(M)$.

    In Morse homology, it is more natural to define cohomology as follows:
    \[
        C^{k} = \Hom(C_{n-k}(-f), \Z)
    ,\]
    with differential $\partial^{k+1}:C^{k} \to  C^{k+1}$ the adjoint of $\partial_{k+1}$.
    With these conventions, it is clear that there exists an isomorphism $t_k: C_k \to  C^{n-k}$. 
    Let us show that this is a chain map, from which the desired result follows.
    In other words we need to show that
    \[
    t_{k-1}  \circ  \partial_k = \partial^{n-k+1}  \circ  t_k
    .\] 
    Let $b \in C_k(f)$ and $a \in C_{n-k+1}(f)$.
    Then the left hand side becomes
    \begin{align*}
        (t_{k-1}  \circ  \partial_k)(b)(a)
        &= t_{k-1}\Big(\sum_{c \in \Crit_{k-1}f} \NX Xbc c\Big) a \\
        &= \sum_{c \in \Crit_{k-1}f} \NX Xbc c^{*} a\\
        &= \NX X b a
    ,\end{align*} 
    where $c^{*}$ is the dual of $c$ defined by $c^{*}(d) = \delta_{cd}$.
    The right hand side becomes
    \begin{align*}
        (\partial^{n-k+1}  \circ  t_k)(b)(a) &= (\partial^{n-k+1}  b^{*})(a)\\
                                          &= b^{*} \sum_{c \in \Crit_k f} \NX {-X} ac c\\
                                          &= \NX {-X} a b
    .\end{align*} 
    Hence, the last step of the proof is to show that $\NX Xpq = \NX{-X}qp$.
    If we did not count signs, this would be immediately clear.
    However, when working over $\Z$ we need to check that the orientations work out.
    If $M$ is oriented, this forms no problem.
    Indeed, in that case, the orientations of the stable manifolds not only induce a co-orientation of the unstable manifolds, but also an orientation.
    Now it is just a matter of carefully checking the definition of the orientation we put on $\L pq$ to conclude that $\NX X pq = \NX{-X} qp$.
    This finishes the proof.
\end{myproof}

If $M$ is a cobordism we find the following theorem:
\begin{theorem}
    Let $M$ be an oriented cobordism from  $M_0$ to $M_1$.
    Let $f: M \to  [0,1]$ be a Morse function with adapted pseudo-gradient $X$.
    Then
     \[
         H_k(M, M_0; \Z) \cong H^{n-k}(M, M_1; \Z)
    .\] 
\end{theorem}
A proof of this fact can be found in `Differential Geometry' by Kosinski.\sidecite{kosinski2013differential}

\section{The Künneth Formula}
In homotopy theory, the homotopy groups of two spaces relate nicely to the homotopy group of their product: $\pi_n(X \times Y) = \pi_n(X) \times \pi_n(Y)$.
In homology the Künneth formula plays a similar role in homology theory.
\begin{theorem}[Künneth formula]
    Let $M, N$ be two manifolds. Then
    \[
        H_k(M \times N; \Z_2) \cong
        \bigoplus_{i+j  = k} H_i(M; \Z_2) \otimes H_j(N; \Z_2)
    .\]
In other words,
\[
    H_{\bul}(M \times N; \Z_2) \cong H_{\bul}(M; \Z_2) \otimes H_\bul(N; \Z_2)
,\] 
with the tensor product of chain complexes as defined in Chapter~0.
\end{theorem}
\begin{remark}
    The Künneth formula as written above is not true when considering homology over $\Z$.
\end{remark}
\begin{remark}
    We can also express this in a different way using the Poincaré polynomial.
    For this, define $\beta_k(M) = \dim_{\Z_2} H_k(M;\Z_2)$ and let $P_M(t) = \sum_k \beta_k(M) t^{k}$.
    Then the Künneth formula states that $P_{M \times N}(t) = P_M(t) P_N(t)$.

    For example, we have $P_{S^{1}}(t) = 1 + t$, so $P_{S^{1}\times S^{1}\times S^{1}} = (1 + t)^3 = 1 + 3t + 3t^2 + 1t^3$, exactly the result we found in Example~\ref{eg:homology-of-the-three-torus}.
    More general, we have that $\beta_k(T^{n})$ is the $k$th coefficient of $(1+t)^{n}$, i.e.\ $\binom{n}{k}$.
\end{remark}
\begin{myproof}
    Let $f, g$  be two Morse functions and $X, Y$ two pseudo-gradient fields on  $M$ and  $N$.
    Then $f + g$ is a Morse function on $M \times N$ and $(X, Y)$ is an adapted pseudo-gradient field. If we assume that $X$ and  $Y$ satisfy the Smale condition, then so does $(X,Y)$.
    Critical points of $f+g$ are pairs of critical points of $f$ and $g$ and their indices are sums of the original indices.
    Furthermore, trajectories of $(X, Y)$ correspond exactly to pairs of trajectories of $X$ and $Y$.
    Now, in order to understand the differential $\partial_{(X, Y)}$ on $M \times N$, we are interested in gradient flow lines that connect critical points $(a,b)$ and  $(c,d)$ whose index differ by exactly one.
    It's clear that the only way this can happen is when $a = c$ or $b = d$.\sidenote{
        If $a\neq c$ and  $b \neq d$, then  $\Ind c \ge  \Ind a + 1$ and $\Ind d \ge  \Ind b + 1$, so $\Ind (c, d) \ge  \Ind (a, b) + 2$.
    }

    When we think about this in terms of directed graphs of critical points, like we did in the example of $T^{3}$, we find that the graph of $M \times N$ is the Cartesian product of the graph of $M$ and the graph of  $N$.
    \begin{marginfigure}
        \centering
        \incfig{kunneth-formula}
        \caption{On top: the Morse complexes of $(f, X)$ and $(g, Y)$. On the bottom: the Morse complex of $(f+g, (X+Y))$.}
        \label{fig:kunneth-formula}
    \end{marginfigure}
    With these things in mind, it is easy to check that
    \begin{align*}
        \Phi: \bigoplus_{i+j = k} C_i(f) \otimes C_j(g) &\longrightarrow C_k(f+g) \\
        a \otimes b &\longmapsto (a,b)
    \end{align*}
    is an isomorphism of complexes with the following differentials:
    \[
        (C_\bul(f) \otimes C_\bul(g), \partial_X \otimes 1 + 1 \otimes \partial_Y) \xrightarrow{\Phi}   (C_\bul(f+g), \partial_{(X,Y)})
    ,\]
    where $(C_\bul(f) \otimes C_\bul(g))_k := \bigoplus_{i+j = k} C_i(f) \otimes C_j(g)$.
    Now, taking the homology of both sides, we find
    \[
        \bigoplus_{i+j = k} H_i(M; \Z_2) \otimes H_j(N; \Z_2) \cong H_k(M \times N; \Z_2)
    ,\]
    where we have used that the homology of a tensor product complex is the tensor product of the homologies by Proposition~\ref{prop:hom-tensor-is-tensor-hom}.
\end{myproof}
\begin{eg}
    Let us illustrate the proof with a concrete example.
    Consider the height function $f$ of $S^{1}$. The graph of critical points is illustrated below.
    There are two trajectories from the index $1$ critical point the index $0$ critical point, so $\partial = 0$. This means that $H_0(S^{1}; \Z_2) = H_1(S^{1}; \Z_2) = \Z_2$.

    To find the homology of $T^2 = S^{1} \times S^{1}$, we consider the Morse function $(\theta_1, \theta_2) \mapsto f(\theta_1) + f(\theta_2)$.
    We have illustrated the resulting graph of critical points below, which is just the Cartesian product of the graph associated to $S^{1}$. 
    We have also done this for $T^{3} = S^{1} \times S^{1} \times S^{1}$.
    Because all the trajectories occur in pairs, the differential $\partial$ vanishes. We conclude that $H_k(T^{n}; \Z_2) = \Z_2^{\binom{n}{k}}$.
\begin{figure}[H]
    \centering
    \sidecaption{Graph of critical points of the Morse functions on $S^{1}$, $T^2$ and $T^3$.
    \label{fig:torus-homology}
    }
    \incfig{torus-homology}
\end{figure}
\end{eg}


\section{Morse inequalities}
The Morse inequalities give a lower bound for the number of critical points of a Morse function $f:M \to  \R$ in terms of the homology of $M$.
In this section, we will discuss many different versions of the Morse inequalities, some stronger than others.

\subsection{Morse inequalities over $\Z_2$}
Let us start with the simplest version of the Morse inequalities.

\begin{theorem}[Weak Morse inequalities]
    Let $f: M \to  \R$ be a Morse function. Then
    \[
        \# \Crit f \ge \sum \dim H_k(M; \Z_2)
    ,\]
    and more specifically,
    \[
        \# \Crit_k f \ge \dim H_k(M; \Z_2)
    .\]
\end{theorem}
\begin{myproof}
    With everything we have set up so far, this is actually a very straightforward result, following from the fact that \[
    H_k(M; \Z_2) = \frac{\Ker \partial_k}{\Im \partial_{k-1}},
    \] so $\dim H_k(M; \Z_2) = \dim \frac{\Ker \partial_k}{\Im \partial_{k-1}} \le  \dim C_k = \# \Crit_k f$.
\end{myproof}

A result in similar vein is the following:
\begin{theorem}
    Let $f: M \to  \R$ be a Morse function. Then
    \[
        \sum (-1)^{k} \# \Crit_k f = \sum (-1)^{k} \dim H_k(M; \Z_2)  =: \chi(M)
    .\]
    Considering this equality modulo $2$, we get
    \[
        \# \Crit f  \equiv \sum \dim H_k(M; \Z_2) \mod 2
    .\]
\end{theorem}
\begin{myproof}
    Use the fact that 
    \[
        H_k(M; \Z_2) = \frac{\Ker \partial_k}{\Im \partial_{k-1}} \quad \text{and} \quad \# \Crit_k f = \dim C_k,
    \]
    together with the rank-nullity theorem for vector spaces.
    A simple computation completes the proof.

    To visualize this proof, have a look at Figure~\ref{fig:linear-map-rank-nullity-theorem}, expressing the rank-nullity theorem, which in this context says that the two slanted lines are parallel, implying that $\dim V - \dim \Ker T = \dim \Im T$.
    \begin{marginfigure}
        \centering
        \incfig{linear-map-rank-nullity-theorem}
        \caption{Visual depiction of the rank-nullity theorem stating that $\dim \Im T + \dim \Ker T = \dim V$.}
        \label{fig:linear-map-rank-nullity-theorem}
    \end{marginfigure}
    \begin{marginfigure}
        \centering
        \incfig{morse-chain-complex-visualized}
        \caption{
            Top: same illustration as above, this time for the Morse complex with its differential.
            Each orange line corresponds to a homology group.
            Bottom: The alternating sum of the dimensions of $C_k$ equals the alternating sum of the dimensions of $H_k$.
        }
        \label{fig:morse-chain-complex-visualized}
    \end{marginfigure}
    \begin{marginfigure}
        \centering
        \incfig{morse-chain-complex-visualized-truncated}
        \caption{Truncating the above picture, we find that the alternating sum of the dimensions of $C_k$ is greater than the alternating sum of the dimensions of  $H_k$. All the thick black lines cancel, except the one circled, giving rise to the inequality.
        }
        \label{fig:morse-chain-complex-visualized-truncated}
    \end{marginfigure}
    Repeating this diagram for $\partial_k$, remembering that  $\partial_k^2 = 0$, gives Figure~\ref{fig:morse-chain-complex-visualized} (top), where we have highlighted the dimension of the homology spaces in orange.
    The bottom part of Figure~\ref{fig:morse-chain-complex-visualized} shows that when we consider the alternating sum of the dimensions of $C_k$, the thick black lines cancel, leaving us with the alternating sum of the dimensions of the homology $H_k$.
    \end{myproof}

    We can also truncate this argument, considering only a partial alternating sum, illustrated in Figure~\ref{fig:morse-chain-complex-visualized-truncated}.
    In this case, we do not have equality (the reason has been indicated in the figure), but we do have the following result:
\begin{theorem}[Strong Morse inequalities]
    For any Morse function $f: M \to  \R$ and for any $m = 0, \ldots, n$, the following inequality holds:
    \[
        \sum_{k=0}^{m} (-1)^{k+m} \# \Crit_k f \ge  \sum_{k=0}^{m} (-1)^{k+m} \dim H_k(M; \Z_2)
    .\]
\end{theorem}

It is easy to check that the strong Morse inequalities are in fact stronger: the weak version can be obtained by by subtracting the strong inequalities for $m$ and  $m+1$.

\subsection{Morse inequalities over $\Z$ and $\Z_p$}

In this section, we will generalize the Morse inequalities by working over other rings than $\Z_2$. More specifically we will consider the Morse inequalities over $\Z$ and $\Z_p$, where $p$ is any prime.


Let us first consider the case of $\Z_p$ (or any other field for that matter).
First of all,
we should mention that defining Morse homology over $\Z_p$ gives no problems if we choose orientations of the stable manifolds, similarly as we have done for $\Z$. Moreover,
because $\Z_p$ is a field,
the proof given above can be simply repeated. In conclusion, we have the following:

\begin{theorem}
    The (weak and strong) Morse inequalities hold over $\Z_p$ for any prime $p$.
\end{theorem}

When working over $\Z$, it not immediately clear how we can generalize the Morse inequalities: $ \Z$ is not a field so the dimension of a $\Z$-module is not defined.
Therefore, let us introduce some different notions of rank of a $\Z$-module, generalizing the concept of dimension.
\begin{definition}[Rank\sidenotemark]
    Let $A$ be a  $\Z$-module, and $p$ be a prime.
    Then the following notions of rank are invariants of $A$:
    \begin{align*}
        r_0(A) &:= \parbox[t]{6.2cm}{cardinality of a maximal set of independent elements of infinite order}\\[0.3em]
            &= \dim_{\Q}(A \otimes_{\Z} \Q) \tag{free rank}
            \\
        r_p(A) &:= \parbox[t]{6.2cm}{cardinality of a maximal set of independent elements of order $p^{k}$ for any $k$}\\[0.3em]
        r_t(A) &:= \sum_{p} r_p(A) \tag{torsion rank}
        \\[0.3em]
        r(A) &:= r_0(A) + \sum_{p}r_p(A) \tag{total rank}
    .\end{align*}
\end{definition}
\sidenotetext[][-6.2cm]{\fullcite{fuchs1970infinite}}
\begin{eg}
    Let $A = \Z^2 \oplus \Z_4 \oplus \Z_3 \oplus \Z_2$.
    Then
    \[
        r_0(A) = 2 \qquad
        r_2(A) = 2 \qquad
        r_3(A) = 1
    .\]
    The torsion rank is $r_t(A) = 3$ and the total rank is $r(A) = 5$.
\end{eg}
We have the following relations between ranks of submodules:
\begin{lemma}
    Let $A$ and $B$ be $\Z$-modules and suppose $B$ is a submodule of $A$.
    Then
    \begin{enumerate}[(i)]
        \item $r(B) \le  r(A)$
        \item $r(A) \le  r(B) + r(A / B)$
        \item  $ r_0(A) = r_0(B) + r_0(A/B)$ \label{label:zmodules-last}
    \end{enumerate}
\end{lemma}

Note in particular identity~\ref{label:zmodules-last}, which is a rank-nullity theorem in the context of the $r_0$ rank.
Also note that the modules $C_k(f, \Z)$ over $\Z$ with as generators the critical points of $f$, are free, so $\# \Crit_k f =r_0(C_k(f, \Z))$.
These two facts combined give the following result:
\begin{theorem}
    The (weak and strong) Morse inequalities hold over $\Z$, in the following sense:
    \[
        \# \Crit_k f \ge  r_0(H_k(M; \Z))
    ,\]
    and for any $m = 0, \ldots, n$ we have
        \[
            \sum_{k=0}^{m} (-1)^{k+m} \# \Crit_k f \ge  \sum_{k=0}^{m} (-1)^{k+m} r_0(H_k(M; \Z))
        .\]
\end{theorem}
\begin{myproof}
    Similar as before, replacing $\Z_2$ by $\Z$ and $\dim$ by $r_0$.
\end{myproof}




\subsection{Morse inequalities with torsion rank}

Let us lastly give a stronger version of the Morse inequalities by using the torsion rank.
\begin{theorem}[Pitcher inequalities\sidenotemark]
    Let $f: M \to  \R$ be a Morse function.
    Then
    \[
    \# \Crit_k f \ge r( H_k(M; \Z)) + r_t(H_{k-1}(M; \Z)).
\]
\end{theorem}
\sidenotetext[][-2cm]{\fullcite{Pitcher1958InequalitiesOC}}
\begin{proof}
    We use $H_k = H_k(M; \Z)$ for brevity.
    \begin{align*}
        r(H_k) + r_t(H_{k-1}) = r\left( \frac{\Ker \partial_k}{\Im \partial_{k+1}} \right) + r_t \left( \frac{\Ker \partial_{k-1}}{\Im \partial_k} \right) 
    .\end{align*}
    Now, note that $\Ker \partial_k$ and $\Im \partial_k$ are free. Hence $r_t\left(\frac{\Ker \partial_{k-1}}{\Im \partial_k}\right)\le  r (\Im \partial_k)$.
    Moreover, $r\left( \frac{\Ker \partial_k}{\Im \partial_{k+1}} \right) \le r(\Ker \partial_k)$.
    This gives
    \begin{align*}
        r(H_k) + r_t(H_{k-1})  &\le  r(\Im \partial_k) + r (\Ker \partial_k)\\
                               &= r_0(\Im \partial_k) + r_0 (\Ker \partial_k),
    \end{align*} 
    again because $\Im \partial_k $ and  $\Ker \partial_k$ are free.
    Now notice that $r_0(C_k) = r_0(\Im \partial_k) + r_0(\Ker \partial_k)$.
    This proves that
    \[
        r(H_k) + r_t(H_{k-1}) \le  r_0 (C_k)
    ,\] 
    from which the desired result follows.
\end{proof}


