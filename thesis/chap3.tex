\chapter{Morse homology}
\label{chap:morse-homology}

Morse homology is a way of associating global invariants to a manifold equipped with a Morse function $f$ and an adapted pseudo-gradient $X$.
In this long chapter, we will define Morse homology and prove three fundamental theorems. Let us give an outline.

As with any homology theory, Morse homology is based on a chain complex, called the Morse complex, which we introduce in Section~1.
This complex consists of spaces $C_k(f)$ generated by the critical points of  $f$, and the differential $\partial_X: C_k \to  C_{k-1}$ counts trajectories between critical points. After introducing these concepts, we compute the Morse homology of some examples.

In Section 2, we prove that the Morse complex is actually a complex which comes down to proving that $\partial_X^2 = 0$.
The proof, while rather long and technical, is based on illuminating geometrical ideas that have inspired many other homology theories, including Floer homology.

In Section~3, we show that Morse homology does not depend on the chosen Morse function and pseudo-gradient.
This result is two-sided. On the one hand, it is disappointing that Morse homology does not capture any information about the dynamics of the Morse function and pseudo-gradient. On the other hand, it can be very useful to have a lot of freedom choosing input parameters without changing the resulting homology. For example, changing $f \leadsto -f$ does not change the homology and this will lead to a proof of Poincar√© duality.

Section~4 concerns Morse homology over $\Z$. We will see that homology over $\Z$ captures more information than homology over $\Z_2$. For example $\Z$-homology can distinguish a Klein bottle from a torus while (the easier to define) $\Z_2$-homology does not.

In the last section of this chapter, we show that Morse homology is actually isomorphic to singular homology.
We will do this by showing that it is isomorphic to de Rham homology which is based on currents. This last fundamental theorem concludes this chapter.

% \startcontents[chapters]
% \printcontents[chapters]{}{1}{}

\section{Morse complex}
In order to define the Morse complex, we need a sequence of modules over a certain ring and maps between these modules.
Most of the time, we will be working over $\Z/2\Z$, which we will denote by $\Z_2$, but sometimes the ring $\Z$ will be used instead. As will turn out, working over $\Z_2$ will allow us not to worry about orientation and it being a field also has some advantages.

The modules we will be considering depend on a Morse function $f$ and consist of formal sums of critical points of a certain index:
\[
    C_k(f) = \Big\{ \sum_{p \in \Crit_k f} n_p p  \mid n_p \in \Z_2\Big\}  = \bigoplus_{p \in \Crit_k f} \Z_2 p
.\] 
Note that this implies that $C_{-1} = C_{-2} = \cdots = 0$ and $C_{n+1} = C_{n+2} = \cdots = 0$, where $n$ is the dimension of the manifold.


\begin{marginfigure}
    \centering
    \incfig{other-sphere-morse-complex-modules}
    \caption{The critical points of the height function can be split up depending on their index and form the generators of the modules in the Morse complex.}
    \label{fig:other-sphere-morse-complex-modules}
\end{marginfigure}

\begin{eg}
    Consider the `other sphere' in Figure~\ref{fig:other-sphere-morse-complex-modules}. We have
    \[
    C_0 = \{0, a\}  \qquad C_1 = \{0, b\}  \qquad C_2 = \{0, c, d, c+d\} 
    .\] 
\end{eg}

The definition of the differential is based on a pseudo-gradient $X$: it counts trajectories connecting critical points of lower index.
Because critical points of index $k$ generate $C_k$, it suffices to define $\partial_{X,k}$ on these critical points and extend linearly:
\begin{align*}
    \partial_{X, k}: C_k &\longrightarrow C_{k-1} \\
    p &\longmapsto \sum_{q \in \Crit_{k-1} f} \nX Xpq q
,\end{align*}
where $\nX Xpq$ is the number of trajectories of $X$ connecting $p$ and $q$, modulo $2$.
If we require that $X$ satisfies the Smale condition, we will later show that this is well defined, by which we mean that $n_X(p,q)$ is an integer (see also Remark~\ref{remark:trajectories-finite}).
If it is clear from the context, we will often drop $X$, $k$ or both from the notation.
\begin{eg}
    Consider again the `other sphere' with its height function.
    Let $X$ be the gradient induced from the standard gradient in $\R^3$.
    Then $\partial_X$ is defined as follows, keeping in mind that we are working over $\Z_2$ and that $C_{-1} = 0$:
\begin{figure}[H]
    \centering
    \sidecaption{The Morse differential $\partial_X$ counts the number of trajectories connecting critical points.
    }
    \incfig{morse-homology-other-sphere-differential}
\end{figure}
\end{eg}

This allows us to define the Morse complex and Morse homology.
\begin{definition}[Morse complex]
    Let $f:M \to \R$ be a Morse function and $X$ a pseudo-gradient with the Smale property.
    Then the Morse complex is given by 
    \[
        \cdots \xrightarrow{\partial} C_2(f) \xrightarrow{\partial}  C_1(f) \xrightarrow{\partial} C_0(f) \textcolor{gray}{{} \xrightarrow{\partial}  0 \xrightarrow{\partial }0 \xrightarrow{\partial}  \cdots}
    \] 
    The Morse homology $\HM{f}{X}$ is the homology of this chain complex.
\end{definition}
The attentive reader will have noticed that for this to be a chain complex, we need $\partial^2 = 0$, which is not obvious at all.
Apart from this, we also would to like to prove that  this homology does not depend on the choice of the Morse function $f$ and the pseudo-gradient field $X$.
We will address these topics in the two following sections, but let us first compute the Morse homology of some examples.


\begin{marginfigure}
    \centering
    \incfig{other-sphere-and-normal-sphere-morse-complex}
    \caption{Two embeddings of the sphere in $\R^3$.
        The corresponding height functions are Morse functions and give rise to a different Morse complex.
        However, the resulting Morse homology is the same.
    }
    \label{fig:other-sphere-and-normal-sphere-morse-complex}
\end{marginfigure}

\begin{eg}[Homology of the (other) sphere]
    We have already computed the differential in the previous example,
    so computing the homology is just a matter of applying the definition.
    \begin{itemize}
        \item $\HM[0]{f}{X} = \dfrac{\Ker \partial: C_0 \to  C_{-1}}{\Im \partial: C_1 \to  C_0} = \dfrac{\{0, a\} }{\{0\} } \cong \Z_2$
        \item $\HM[1]{f}{X} = \dfrac{\Ker \partial: C_1 \to  C_{0}}{\Im \partial: C_2 \to  C_1} = \dfrac{\{0, b\} }{\{0, b\} } \cong 0$
        \item $\HM[2]{f}{X} = \dfrac{\Ker \partial: C_2 \to  C_{1}}{\Im \partial: C_3 \to  C_2} = \dfrac{\{0, c+d\}}{\{ 0\}} \cong \Z_2$
    \end{itemize}
    In summary, we have
    \[
        H_0 = \Z_2 \qquad H_1 = 0 \qquad H_2 = \Z_2
    .\] 

    Instead of embedding $S^2$ in this strange way, we can also repeat the same calculation with its standard embedding, illustrated in Figure~\ref{fig:other-sphere-and-normal-sphere-morse-complex}.
    We have $ C_2 = \{0, b\} $, $ C_1 = \{0\} $  and $C_0 = \{0, a\}$, and $\partial(b) = 0$,  $\partial(a) = 0$.
    This way, we obtain
    \begin{itemize}
        \item $\HM[0]{g}{Y} = \dfrac{\Ker \partial: C_0 \to  C_{-1}}{\Im \partial: C_1 \to  C_0} = \dfrac{\{0, a\} }{\{0\} } \cong \Z_2$  
        \item $\HM[1]{g}{Y} = \dfrac{\Ker \partial: C_1 \to  C_{0}}{\Im \partial: C_2 \to  C_1} = \dfrac{\{0\} }{\{0\} } \cong 0$
        \item $\HM[2]{g}{Y} = \dfrac{\Ker \partial: C_2 \to  C_{1}}{\Im \partial: C_3 \to  C_2} = \dfrac{\{0, b\} }{\{0\} } \cong \Z_2$
    \end{itemize}
    In summary, we have 
    \[
    H_0 = \Z_2 \qquad H_1 = 0 \qquad H_2 = \Z_2
    ,\] 
    exactly the same homology as with the other Morse function and other gradient.
    As mentioned earlier, we will prove that this is in general the case.
\end{eg}
\begin{eg}[Homology of the three-torus]
    \label{eg:homology-of-the-three-torus}
    Let us recall Example~\ref{eg:handle-decomposition-three-torus}, which discusses the three-torus $T^{3} = S^{1} \times S^{1} \times S^{1} = \R^3 / \Z^3$ and the following Morse function
    \begin{align*}
        f: T^3 &\longrightarrow \R \\
        (x,y,z) &\longmapsto 2 \cos(2 \pi x)+ 3 \cos(2 \pi y) + 4 \cos (2 \pi z),
    \end{align*}
    with critical values repeated here for convenience:
    \begin{marginfigure}
        \centering
        \incfig{morse-homology-three-torus-trajectories}
        \caption{
        Trajectories connecting critical points whose index differ by exactly $1$.
        Here $T^{3} = \R^{3} / \Z^{3}$ and we have drawn $\big(-\frac{1}{2}, \frac{1}{2}\big]^3$ as representative cube.  }
        \label{fig:morse-homology-three-torus-trajectories}
    \end{marginfigure}
    \[\begin{array}{cccccc}
  & x & y  & z & f(x, y, z) & \text{Index}\\ \hline
  & 0 & 0 & 0 & 9 & 3 \\
& \frac{1}{2} & 0 & 0 & 5 & 2 \\
& 0 & \frac{1}{2} & 0 & 3 & 2 \\
& 0 & 0 & \frac{1}{2} & 1 & 2 \\
& \frac{1}{2} & \frac{1}{2} & 0 & -1 & 1 \\
& \frac{1}{2} & 0 & \frac{1}{2} & -3 & 1 \\
& 0 & \frac{1}{2} & \frac{1}{2} & -5 & 1 \\
& \frac{1}{2} & \frac{1}{2} & \frac{1}{2} & -9 & 0 \\
    \end{array}\]
    \begin{marginfigure}
        \centering
        \incfig{mores-homology-three-torus-critical-points-graph}
        \caption{Graph of the critical points of $f$ on $T^{3}$.
            Each edge represents a flow line between points whose indices differ by one.
        }
        \label{fig:mores-homology-three-torus-critical-points-graph}
    \end{marginfigure}
    The differential equation for trajectories along $\grad f$ is 
    \begin{align*}
        \dot x &= -4 \pi \sin(2 \pi x)\\
        \dot y &= -6 \pi \sin(2 \pi y)\\
        \dot z &= -8 \pi \sin(2 \pi z)
    .\end{align*} 


    Note that $\dot x$ only depends on  $x$,  $\dot y$ on  $y$ and  $\dot z$ on $z$, so this is a decoupled system that is easy to solve.
    Requiring that for $t \to  \pm\infty$ we end up in critical points, we find the trajectories in Figure~\ref{fig:morse-homology-three-torus-trajectories}.
    To have a better overview, we can also make a graph of critical points and trajectories between them, as is done in Figure~\ref{fig:mores-homology-three-torus-critical-points-graph}.
    This graph provides all the information we need to compute the Morse homology of $T^{3}$.
    Note that all critical points are connected with two gradient lines, which means that each differential $\partial_3, \partial_{2}, \partial_1, \partial_0$ is the zero map, making it very easy to compute the homology. In the end, we get
    \[
    H_0 = \Z_2 \qquad 
    H_1 = \Z_2^3 \qquad 
    H_2 = \Z_2^3 \qquad 
    H_3 = \Z_2
    ,\] 
    which corresponds to the usual homology.
\end{eg}

\section{The Morse complex is a complex: $\partial^2 = 0$}
In this section, we will prove that the Morse complex is actually a complex, by which we mean that $\partial^2 = 0$.
The core idea of the proof is very geometrical and depends on the fact that compact one-dimensional manifolds with boundary have an even number of boundary points.\sidenote{
    Compact one-dimensional manifolds consist of disjoint unions of copies of $S^{1}$ and closed intervals, as proven in \fullcite[p.55]{milnor1997topology}.
}
We will first clarify this core idea, and then make this argument precise.

Let us first state clearly what we have to prove. Let $a \in \Crit_k f$ be a critical point of a Morse function $f: M \to  \R$.
We need to prove that $\partial^2(a) = 0$, so\begin{align*}
    \partial^2(a) &= \partial \Big(\sum_{c \in \Crit_{k-1} f} n_X(a, c) c\Big)\\
                  &= \sum_{b \in \Crit_{k-2} f} \sum_{c \in \Crit_{k-1} f} n_X(a, c) n_X(c, b) b
.\end{align*} 
We see that $\partial^2(a)$ counts trajectories from $a$ to points of index $k-2$ that are once broken in a critical point of index $k-1$.
We are working over $\Z_2$, so if we can prove that these once broken trajectories always occur in pairs, we are done.

The core idea of the proof is to notice that there is a one parameter family $\L ab$ of unbroken trajectories connecting the broken trajectories, as illustrated in Figure~\ref{fig:morse-complex-is-a-complex-idea-of-proof}.
\begin{marginfigure}
    \centering
    \incfig{morse-complex-is-a-complex-idea-of-proof}
    \caption{
        Core idea of the proof stating $\partial^2 = 0$.
        There are two unbroken trajectories from $a$ to $b$, one passing through $c_1$ and one through $c_2$.
        There is a one parameter family of unbroken trajectories interpolating between the two broken ones.
        Together, they form a compact 1-dimensional manifold with boundary, which has an even number of boundary points.
    }
    \label{fig:morse-complex-is-a-complex-idea-of-proof}
\end{marginfigure}
More specifically the space of unbroken trajectories $\L ab $ is a one-dimensional manifold, and by adding in the once broken trajectories between $a$ and $b$, we can compactify this manifold, resulting in the space which we will denote with $\Lb ab$:
\[
\Lb ab = \L ab \cup \bigcup_{c \in \Crit_{k-1} f} \L ac \times \L cb
.\] 
This turns out to be a compact $1$-manifold, and its boundary consists exactly of the broken trajectories.
Because a $1$-manifold always has an even number of boundary points, this shows that once-broken trajectories come in pairs, proving that  $\partial^2 = 0$.

Before we proceed with this idea, let us give an overview of the steps that need to be taken.

\begin{enumerate}
    \item Define $\Lb ab$, the space of all (broken and unbroken) trajectories.
    \item Define a topology on $\Lb ab$.
    \item Prove that  $\Lb ab$ is the compactification of $\L ab$.
    \item Prove that if $\Ind a - \Ind b = 2$, then $\Lb ab$ is a 1-dimensional manifold with boundary the once broken trajectories between $a$ and  $b$.
\end{enumerate}

\subsection{The space of broken trajectories}
\begin{definition}
    The space of broken trajectories between $a$ and  $b$ is
     \[
         \Lb ab = \bigcup_{\substack{\{c_1, \ldots, c_\ell\} \subset \Crit f\\ c_i \text{ distinct}}} \L a{c_1} \times \L {c_1}{c_2} \times  \cdots \times \L {c_\ell}b
    .\] 
\end{definition}
\begin{remark}
    Notice that $\L p q = \O$ if $\Ind p \le \Ind q$, so the only broken trajectories that contribute to the union satisfy $\Ind a > \Ind c_1 > \cdots >\Ind c_\ell > \Ind b$.
    Moreover, note that this set also contains the `zero-times' broken trajectories,  i.e.\ $\L ab$ itself.
\end{remark}
    The number $\ell$ describes how many times the trajectory is broken.
    In other words, each broken trajectory in $\L a{c_1} \times \L {c_1}{c_2} \times  \cdots \times \L {c_\ell}b$ has $ \ell+1$ segments,  and we will denote such a trajectory by $(\lambda_1, \lambda_2, \cdots, \lambda_{\ell+1})$.
    As discussed above, in the case of $\Ind a = k$, $\Ind b = k -2$, this definition results in 
    \[
        \Lb ab = \L ab \cup  \bigcup_{c \in \Crit_{k-1} f}  \L a{c} \times \L {c} b
    ,\] 
    which makes it clear it is the union of unbroken and once broken trajectories.

\subsection{Topology of $\Lb ab$}
% Also remember that $\L ab$ is homeomorphic to $\traj ab \cap f^{-1}(\alpha)$ for some regular value $\alpha$ between $f(a)$ and $f(b)$,


\begin{marginfigure}
    \centering
    \incfig{morse-homology-definition-of-topology}
    \caption{The topology on $\Lb ab $ is defined by looking at the entrance and exit points in the Morse charts.
        Here we have shown in black paths that lie in a neighborhood of the broken path $(\lambda_1, \lambda_2) \in \Lb ab$.
    }
    \label{fig:morse-homology-definition-of-topology}
\end{marginfigure}
To define a topology on $\Lb ab$,
we will describe a basis around a (possibly broken) trajectory.
Let $\lambda = (\lambda_1, \lambda_2, \ldots, \lambda_q)$ be a trajectory in $\Lb ab$.
Consider Morse charts around each critical point  $a, c_1, c_2, \ldots, c_{q-1}, b$.
Take opens around entry and exit points of the trajectories, lying in level sets of $f$, indicated in the figure with thick black lines.
We declare all trajectories passing through these opens to be in a open neighborhood of $(\lambda_1, \lambda_2, \ldots, \lambda_q)$.
Doing this for all possible `entrance and exit opens' defines a basis of the topology.

\begin{remark}
    If $\lambda$ is unbroken, we have $\L ab \cong \traj ab \cap  f^{-1}(\alpha)$ for some regular value $\alpha$, and topology on $\L ab$ corresponds to the subspace topology on $\traj ab \cap  f^{-1}(\alpha) \subset M$.
\end{remark}

In conclusion, the essence of this topology on $\Lb ab$ is: `trajectories are nearby if entrance and exit points in Morse charts are nearby'.

\subsection{$\Lb ab$ is the compactification of $\L ab$}
Now we are ready to prove that $\Lb ab$ is compact, and in fact a compactification of  $\L ab$. By this last statement, we mean that there are points in $\L ab$ arbitrary close to ones in  $\Lb ab$.
In topological terms, any open around a broken trajectory in $\L ab$ contains unbroken trajectories, i.e.\ elements of $\L ab$.
\begin{theorem}
    $\Lb ab$ is compact.
\end{theorem}

In the proof of this theorem, we will need the following lemma, stating that points $y_n$ on trajectories that pass through a convergent sequence of points $x_n \to x$ also converge, at least if $y_n$ all lie on the same level:
\begin{marginfigure}
    \centering
    \incfig{lemma-partial-squared-zero-proof}
    \caption{A convergent sequence $x_n \to  x$ defines a sequence of trajectories. If $y_n$ is a sequence of points that lie on these trajectories, then it also converges to a point $y$ lying on the trajectory that passes through $x$.}
    \label{fig:lemma-partial-squared-zero-proof}
\end{marginfigure}
\begin{lemma}
    Let $x$ be a regular point of $f$ and $x_n \to x$.
    Let $y_n$ and  $y$ be points lying on the same trajectory of $X$ as  $x_n$ and  $x$.
    Suppose all $y_n$ lie on the same level as  $y$, i.e.\ $f(y_n) = f(y)$.
    Then  $y_n \to  y$.
    \label{lemma:level-sets}
\end{lemma}
\begin{myproof}
    The idea of the proof is to flow $y_n$ to  $x_n$ and $y$ to $x$ so that convergence of $x_n$ implies convergence of $y_n$.
    Let  $\psi_t$ be the flow of  $-\frac{1}{df (X)} X$ on a subset of $M$ that contains $x_n, y_n, x, y$ for large enough  $n$ and does not contain critical points.
    Then $f(\psi_t(z)) = f(z) - t$, so
     \begin{align*}
         y_n &= \psi_{-f(y_n) + f(x_n)}(x_n)\\
         &= \psi_{-f(y) + f(x_n)}(x_n)\\
         & \qquad \tikz \draw[->]  (0,0) -- (0,-0.5) node[midway, right]{\footnotesize$n \to  \infty$};\\[-0.4em]
         &\mbox{}\phantom{{}={}}\psi_{-f(y) + f(x)}(x) = y
    .\end{align*} 
\end{myproof}

Let us now prove that $\Lb ab$ is compact.
We will do this by proving that this space is sequentially compact. 
This is enough, because the topology on $\Lb ab$ is second countable (coming from the topology on $M$), which implies that compactness, countable compactness, sequentially compactness, etc.\ are equivalent properties.

\begin{figure}[H]
    \centering
    \sidecaption{
        To show that $\Lb ab$ is compact, we consider a sequence of paths $\ell_n$ in $\L ab$ and find an accumulation trajectory, i.e.\ a limit of a subsequence.
        In case 1, the accumulation trajectory lies in $\L ab$.
        Case 2 shows the situation when the accumulation trajectory is broken in  $c$ (and possibly in multiple other critical points).
    \label{fig:partial-squared-zero-space-compact}
    }
    \incfig{partial-squared-zero-space-compact}
\end{figure}



\begin{myproof}
    Let us first consider a sequence of unbroken trajectories, i.e.\ a sequence $\ell_n$ in $\L ab$.
    Let $\Omega(a)$ be a Morse chart around $a$.
    Consider the points where $\ell_n$ exits the Morse chart $a$, call them $a_n^{-}$.
    Using compactness of the sphere, extract a subsequence of $\ell_n$ such that $a_{n}^{-}$ converges and call the point of convergence $a^{-}$.
    We will denote the extracted subsequence again by $\ell_n$ and will do so continuously in the proof.
    Similarly, extract a subsequence such that $b_n^{+}$, defined as the entry point in the Morse chart of $b$ converges to a point $b^{+}$.
    In conclusion, we have a subsequence whose exit point in $\Omega(a)$  converges to $a^{-}$ and whose entrance in $\Omega(b)$ converges to  $b^{+}$.

    Let us now try to construct a trajectory that is the `accumulation trajectory'\sidenote{By this, we simply mean an accumulation point of the sequence $\ell_n$, but this terminology can be confusing because it is not a point in the geometrical sense of the word.} of $\ell_n$.
    An obvious starting point would be to consider the unique trajectory $\gamma_1$ passing through $a^{-}$ going from $a$ to another critical point.
    Suppose for a moment that this other critical points is in fact $b$, so $\gamma_1$ connects  $a$ and  $b$, as in case 1 in Figure~\ref{fig:partial-squared-zero-space-compact}.
    Lemma~\ref{lemma:level-sets} implies that the entry points of $\ell_n$ in $\Omega(b)$ converge to the entry point of $\gamma_1$. This then proves that $\ell_n \to  \gamma_1$\sidenote{
        By definition of our topology, a sequence of unbroken trajectories connecting $a$ to  $b$ ($\ell_n$) converges to an unbroken trajectory ($\gamma_1$) if entry and exit points converge.
    }.

    In the other case , when $\gamma_1$ connects $a$ and another critical point $c \neq b$, the accumulation trajectory of $\ell_n$ will be a trajectory that is at least broken in $c$.
We have again that the entry points of $\ell_n$ in $\Omega(c)$ (call them $c_n^{+}$) converge to the entry point of $\gamma_1$, so the first segment of the accumulation trajectory will be $\gamma_1$.
To find the second segment of the accumulation trajectory, we would again want a starting point (like we had $a^{-}$ before) in the unstable manifold of $c$ to flow from in order to find $\gamma_{2}$.
For this, extract a subsequence of $\ell_n$ such that their exit points $c^{-}_n$ in $\Omega(c)$ converge to a point $c^{-}$.
We claim that $c^{-}$ lies in the unstable manifold of $c$.\sidenote{
    Suppose that it does not.
    Then we could flow back $c^{-}$ to a point $c^{\star}$ with $f(c^{\star}) = f(c^{+})$.
    Note that $c^{\star}$ is not in the stable manifold of $c$. (Otherwise, flowing forward again we would end up in  $c$)
    Applying the lemma again, $c_n^{+} \to  c^{\star}$ meaning that $c^{\star} = c^{+}$. This cannot be right since $c^{\star}$ is not in the stable manifold of $c$, but $c^{+}$ is, by definition.
}
This means that when we flow back, we indeed get to $c$ like we wanted, and when we flow forward, we get to another critical point, which may be $b$, or $d$, yet another critical point. This way we go on and find a subsequence of $\ell_n$ that converges to~$(\gamma_1, \gamma_2, \ldots, \gamma_k)$.

In order to complete the proof for a sequence $\ell_n$ in $ \Lb ab$ (instead of $\L ab$), note that for sufficiently large $n$ and after extracting a subsequence, the critical points where $ \ell_n$ is broken do not change. Then apply the proof above to the first segment, then to the second, \ldots
\end{myproof}

Note that this proof also encapsulates the fact that $\Lb ab$ is actually the compactification of  $\L ab$, in the sense that there are elements of  $\L ab$ that are arbitrarily close to a fixed element of $\Lb ab$.


\subsection{$\Lb ab$ is a 1-dimensional manifold with boundary}

The last step we need to take is showing that that the topological space $\Lb ab$ actually has the structure of a manifold.
More specifically if $\Ind a - \Ind = 2$, then it is a one-manifold with boundary.

\begin{theorem}
    Let $a, b$ be critical points of  $M$ such that  $\Ind a - \Ind b = 2$. Then  $\Lb ab$ is a compact  $1$-dimensional manifold with boundary.
\end{theorem}

\begin{remark}
    In general, the space $\L ab $ when $\Ind a - \Ind b > 2$ is a compact manifold with corners.
    Its interior consists of unbroken trajectories, its codimension $1$-stratum of the once-broken trajectories, its codimension $2$-stratum of the twice-broken trajectories, etc.
\end{remark}

We already know that $\L ab$ is a 1-manifold, so the following proposition immediately implies the theorem.

\begin{prop}
    Let $M$ be a compact manifold and $f: M \to  \R$ a Morse function with adapted pseudo-gradient $X$ satisfying the Smale condition. Let  $a,c,b$ be three critical points of index $k+1, k$ and $k-1$. Let $\lambda_1 \in \L ac$ and $\lambda_2 \in \L cb$.
    There exists a continuous embedding $\psi$ from $[0, \delta)$ to a neighborhood of $(\lambda_1, \lambda_2)$ in $\Lb ab$ such that
    \[
    \begin{cases}
        \psi(0) = (\lambda_1, \lambda_2) \in \Lb ab\\
        \psi(s) \in \L ab \quad \text{ for } s \neq 0.
    \end{cases}
    \] 
    Moreover if $(\ell_n)$ is a sequence in $\L ab$ that tends to $(\lambda_1, \lambda_2)$, then $ \ell_n$ is eventually contained in the image of $\psi$.
\end{prop}

The last part is important in order to show that broken trajectories actually form the boundary, as illustrated in Figure~\ref{fig:l-bar-last-condition-of-manifold-with-boundary}.
\begin{marginfigure}
    \centering
    \incfig{l-bar-last-condition-of-manifold-with-boundary}
    \caption{We can embed a half open interval $[a, b)$ in $\R$, but that does not mean that $a$ is a boundary point of $\R$. Clearly, there exists $x_n \to a$ that is not eventually contained in $[a,b)$.
        Requiring that this last condition always holds ensures that $a$ is actually a boundary point.
    }
    \label{fig:l-bar-last-condition-of-manifold-with-boundary}
\end{marginfigure}

\begin{myproof}
    Let $a,b,c$ be critical points of index $(\Ind a, \Ind c, \Ind b) = (k+1,k,k-1)$.
    \begin{marginfigure}
        \centering
        \incfig{l-bar-manifold-2-dimensional-case}
        \caption{The map $\chi$ is an embedding of a half-open interval $[0, \delta)$ in the level set $\alpha- \epsilon$. Considering the trajectories passing through these points, we get an embdding $\psi: [0, \delta) \to \Lb ab$.}
        \label{fig:l-bar-manifold-2-dimensional-case}
    \end{marginfigure}
    Consider a Morse chart around $c$ that lies between level sets $\alpha \pm \epsilon$ where  $\alpha = f(c)$.
    Let $c^{+}$ be the entry point of $\lambda_1$ in  the Morse chart of $c$.

    The idea is to embed an interval $[0, \delta)$ as in Figure~\ref{fig:l-bar-manifold-2-dimensional-case} in the level set $\alpha - \epsilon$. Call this embedding $\chi$.
    We will then define $\psi(t)$ as the trajectory passing through $\chi(t)$ (for $t>0$) and  $\psi(0) = (\lambda_1, \lambda_2)$.
    The difficulty lies in determining how to embed $[0, \delta)$ inside the level set $\alpha - \epsilon$ such that $\psi$ is continuous at  $0$.
    \begin{marginfigure}
        \centering
        \incfig{l-bar-manifold-2-dimensional-case-part-flow}
        \caption{An overview of the different submanifolds considered in the proof.}
        \label{fig:l-bar-manifold-2-dimensional-case-part-flow}
    \end{marginfigure}
\begin{marginfigure}
    \centering
    \incfig{lbar-manifold-three-dimensional-case}
    \caption{The situation in three dimensions.}
    \label{fig:lbar-manifold-three-dimensional-case}
\end{marginfigure}

\paragraph{Parametrizing trajectories near $\bm{\lambda_1}$}
Let $D^{k}$ be a small $k$-dimensional disk around $c^{+}$ in $f^{-1}(\alpha+\epsilon)$, parametrizing trajectories starting in $a$ near $\lambda_1$.
    Now consider $D^{k} \setminus c^{+}$ and flow this punctured disk along $X$ until it reaches the level set  $\alpha - \epsilon$.
    Points in the resulting manifold $Q \subset f^{-1}(\alpha - \epsilon)$ parametrize trajectories near $\lambda_1$ but not $\lambda_1$ itself.
    By adding the points lying on $S^{-} := \unstable c \tcap f^{-1}(\alpha - \epsilon)$, we get the manifold $\overline{Q} = Q \cup S^{-}$ which is a manifold with boundary $S^{-}$.
    This submanifold $\overline{Q}$ of $f^{-1}(\alpha-\epsilon)$ parametrizes trajectories near $\lambda_1$ (but notice that $\lambda_1$ itself is represented multiple times).


    \paragraph{Parametrizing trajectories ending in $\bm{b}$}
    Let $P = f^{-1}(\alpha - \epsilon) \tcap \stable b$.
    This is again a subspace of $f^{-1}(\alpha-\epsilon)$ that parametrizes trajectories going to $b$.

    \paragraph{Parametrizing trajectories near $\bm{(\lambda_1, \lambda_2)}$}
    The intersection of $P$ and  $\overline{Q}$ is transverse (because of the Smale conditions) and parametrizes (broken and unbroken) trajectories near $(\lambda_1, \lambda_2)$.
    Because of transversality, this intersection is in fact a manifold (with boundary $c^{-}$) and counting dimensions, we find that it has dimension $1$.
    Now it is easy to define the required embedding $\chi: [0, \delta) \to  f^{-1}(\alpha-\epsilon)$, which in turn gives rise to $\psi: [0, \delta) \to  \Lb ab$.\end{myproof}
\subsection{Conclusion}

Let us conclude this section by finally proving that $\partial^2 = 0$.
\begin{theorem}
    Let $X$ be a pseudo-gradient adapted to a Morse function  $f: M \to  \R$ that satisfies the Smale condition.
    Then the Morse differential $\partial_X$ squares to zero.
\end{theorem}
\begin{myproof}
    Let $a$ be a critical point of $f$.
    Then by definition of $\partial$,
    \begin{align*}
        \partial^2(a)
        &= 
        \sum_{b \in  \Crit_{k-2}f}
        \sum_{c \in  \Crit_{k-1}f}
        n_X(a, c) n_X(c, b) \: b.\\
        \shortintertext{By definition of $n_X$,}
        &= 
        \sum_{b \in  \Crit_{k-2}f}
        \sum_{c \in  \Crit_{k-1}f}
        \# (\L ac \times \L cb) \:  b\\
        &= 
        \sum_{b \in  \Crit_{k-2}f}
        \# \Bigg(\bigcup_{c \in  \Crit_{k-1}f}
        \L ac \times \L cb\Bigg) \:  b.\\
        \shortintertext{By definition of $\Lb ab$}
        &= \sum_{b \in  \Crit_{k-2}f} \# (\partial \Lb a b)\:  b.
    \end{align*} 
    Now, $\Lb ab$ is a compact  $1$-manifold and hence has an even number of boundary points. Working over $ \Z_2$, this implies that $\partial^2(a) = 0$.
\end{myproof}

% \filbreak
\section{Morse homology is independent of the Morse function and gradient}
\begin{theorem}
    Let $M$ be a compact manifold and $ f_0, f_1: M \to  \R$ two Morse functions.
    Let $X_0, X_1$ be pseudo-gradients adapted to $f_0$ and $ f_1$ respectively with the Smale property.
    Then there exists a morphism of complexes
    \[
        \Phi_{\bul}:
        (C_\bul(f_0), \partial_{X_0}) \to  
        (C_\bul(f_1), \partial_{X_1})
    ,\] 
    that induces an isomorphism on the level of homology.
\end{theorem}
    
\begin{myproof}
The proof of this theorem features an intricate interplay between homological algebra and differential geometry and is truly something to behold. It is perhaps the most beautiful proof in this thesis.
\paragraph{Construction of a morphism of complexes}
In order to find a relation between the two complexes, we geometrically connect $f_0$ and $f_1$ via a particular type of homotopy, namely  a `stable interpolation' by which we mean a smooth map
\[
    F: [0,1] \times M \to \R: (s, m) \mapsto F_s(m)
,\] 
such that $F_s = f_0$ for $s \in \left[0, \frac{1}{3}\right]$ and $F_s = f_1$ for $s \in \left[\frac{2}{3}, 1\right]$.
On of the reasons of looking specifically at stable interpolations is that we can concatenate them and again get a $C^{\infty}$ map that is a stable interpolation.

We can visualize an interpolation between two Morse functions by embedding $[0,1] \times M$ in $\R^{\ell}$ in such a way that the height function in each slice corresponds to $F_s$.
For example, doing this for the circle and the other circle, we get Figure~\ref{fig:morse-homology-independence-cilinder}.

\begin{marginfigure}
    \centering
    \incfig{morse-homology-independence-cilinder}
    \caption{An interpolation between $f_0$ and $f_1$ can result in degenerate critical points, as shown in the figure in orange:
        a homotopy between Morse functions is not necessarily Morse for all times $s$.
    }
    \label{fig:morse-homology-independence-cilinder}
\end{marginfigure}

Seen from a Morse perspective, the result is less than desirable: the function $F$ is not a Morse function: critical points in the stationary parts of $F$ are degenerate as $\frac{\partial F}{\partial s} = 0$.
Furthermore, an interpolation of two Morse functions need not be Morse at each point in time which gives even more degenerate critical points. We have highlighted an example of this in the figure.

\begin{marginfigure}
    \centering
    \incfig{morse-homology-independence-tube}
    \caption{Adding a function (illustrated below) in the $s$-direction creates a slide overcoming the problem of degenerate critical points.}
    \label{fig:morse-homology-independence-tube}
\end{marginfigure}

\begin{marginfigure}
    \centering
    \incfig{morse-homology-independence-g-function}
    \caption{The function $g$ used to transform the tube into a slide.}
    \label{fig:morse-homology-independence-g-function}
\end{marginfigure}

We can fix this problem by replacing the horizontal tube by a `slide', as seen in Figure~\ref{fig:morse-homology-independence-tube}.
We do this by extending $F$ to $\left[-\frac{1}{3}, \frac{4}{3}\right]$ and adding a function $g$ (illustrated in Figure~\ref{fig:morse-homology-independence-g-function}) along the $s$-direction, i.e.\ $\tilde{F}_s(p) = F_s(p) + g(s)$.\sidenote{We extend the function to the interval $\left[-\frac{1}{3}, \frac{4}{3}\right]$ to make sure that the critical values of $\tilde{F}$ do not lie on the boundary.}
Whatever kind of tube we start with, if we make the slide steep enough, we will always slide down and never have flat spots, except at the top and bottom of the slide.
This means if we choose $g$ appropriately\sidenote{More explicitly, we want $\frac{\partial F}{\partial s} (p, s) + g'(s) <0$ for all $p \in M, s \in (0,1)$.
}, the only critical points lie in the slices $s=0$ and  $s=1$ and correspond to critical points of $f_0$ and $f_1$ respectively.
Because $g$ is Morse, these critical points remain nondegenerate.
We conclude that $\tilde{F}$ is in fact Morse with critical points $\Crit(\tilde{F}) = \{0\} \times \Crit(f_0) \cup \{1\} \times \Crit(f_1)$.

We can also determine the index of these critical points.
Because we have created an extra downward direction at the top of the slide, the indices of these critical points have increased by $1$.
At the bottom, the indices stay the same, giving us
\[
    C_{k+1}(\tilde{F}) = C_k(f_0) \oplus C_{k+1}(f_1)
.\] 

Apart from the critical points, we are also interested in constructing a pseudo-gradient on $[0,1]\times M$, as this will give rise to a differential.
 On $[-\frac{1}{3}, \frac{1}{3}] \times M$, we set $X = X_0 - \grad g$, and on $\left[\frac{2}{3}, \frac{4}{3}\right] \times M$ we set $X = X_1 - \grad g$.\sidenote{Here, $\grad g$ is the Euclidian gradient.}
A partition of unity argument then fills in the gaps.
Note that this pseudo-gradient is transverse to the boundary of $\left[-\frac{1}{3}, \frac{4}{3}\right] \times M$.
We can slightly perturb $X$ to make it satisfy the Smale condition and we can furthermore assume that the resulting vector field, $\tilde{X}$ is transversal to $ \{s\} \times M$ for $s \in \left\{-\frac{1}{3}, \frac{1}{3}, \frac{2}{3}, \frac{4}{3}\right\}$.
We can also make this perturbation small enough such that $\partial_{X} = \partial_{\tilde{X}}$, that is to say, the number of $X$-trajectories between critical points is the same as the number of $\tilde{X}$-trajectories.

Having a Morse function $\tilde{F}$ and a pseudo-gadient $\tilde{X}$ that is adapted to $\tilde{F}$, we can consider the associated Morse complex $(C_\bul(\tilde{F}), \partial_{\tilde{X}})$.
There are two types of trajectories connecting critical points of $\tilde{F}$: ones that stay in the same section ($s = 0$ or $s = 1$)  and ones that connect critical points of $f_0$ to critical points of $f_1$, i.e.\ ones that `slide down the slide'.
This means we can decompose $\partial_{\tilde{X}}$ as follows:
\begin{align*}
    \partial_{\tilde{X}}: C_k(f_0) \oplus C_{k+1}(f_1) &\longrightarrow C_{k-1}(f_0) \oplus C_k(f_1) \\
    (p_0, p_1) &\longmapsto (\partial_{X_0}(p_0), \partial_{X_1}(p_1)+ \Phi^{F}(p_0))
,\end{align*}
where $\Phi^{F}$ counts the trajectories connecting critical points of $f_0$ to ones of $f_1$. We can also write this as a matrix:
\[
\partial_{\tilde{X}} = \begin{pmatrix}
    \partial_{X_0} & 0 \\
     \Phi^{F}& \partial_{X_1}
\end{pmatrix}
.\] 
Readers familiar with homological algebra will recognize this construction as the mapping cone of the map $\Phi^{F}: C_\bul(f_0) \to  C_\bul(f_1)$.

\begin{marginfigure}
    \centering
    \incfig{morse-homology-independence-partial-squared-zero}
    \caption{A visual depiction of the calculation $\partial^2(p)$.}
    \label{fig:morse-homology-independence-partial-squared-zero}
\end{marginfigure}

Let us now look at what the identity $\partial_{\tilde{X}}^2 = 0$ means in this context. Let $p \in C_k(f_0)$.
Then
\begin{align*}
    \partial_{\tilde{X}}^2 (p, 0) &= \partial_{\tilde{X}}(\partial_{0}(p),  \Phi^{F}(p))\\
                                                      &= (\partial_0^2(p), \Phi^{F}\partial_0(p)+ \partial_1 \Phi^{F}(p))\\
                                                    &= (0, \Phi^{F}\partial_0(p)+ \partial_1 \Phi^{F}(p))
.\end{align*} 
Because we are working over $\Z_2$, this means that $\Phi^{F}  \circ  \partial_0 = \partial_1  \circ  \Phi^{F}$, i.e.\ the following diagram commutes for all $k$:
\[
    \begin{tikzcd}
        C_k(f_0) \arrow[d, "\Phi^{F}"]\arrow[r, "\partial_0"] &C_{k-1}(f_0) \arrow[d, "\Phi^{F}"]\\
        C_k(f_1) \arrow[r, "\partial_1"] &C_{k-1}(f_1)\\
    \end{tikzcd}
\]
This proves that $\Phi^{F}$ is a morphism of complexes.

\paragraph{$\bm{\Phi^{F}}$ induces an isomorphism on the level on homology}

We will now prove that this map induces an isomorphism on the level of homology.
Let $f_0, f_1, f_2$ be Morse functions $M \to  \R$.
Suppose $F$ interpolates between $f_0$ and $f_1$,
$G$ between $f_1$ and $f_2$ and $H$ between $f_0$ and $f_2$, i.e.\ we are in the following situation:
\[
    \begin{tikzcd}
        f_0 \arrow[rr, "H"', bend right] \arrow[r, "F"] &f_1 \arrow[r, "G"] &f_2.
    \end{tikzcd}
\]
We claim that the maps induced by $\Phi^{G} \circ \Phi^{F}$ and $\Phi^{H}$ on the level of homology coincide, or equivalently, they are chain homotopic, meaning that there exists an operator $S$ such that
 \[
\Phi^{G}  \circ  \Phi^{F} - \Phi^{H} = \partial S + S \partial
.\] 
This is sufficient to prove that $\Phi^{F}$ induces an isomorphism.
Indeed, it is easy to check that if $I$ is a constant interpolation between  $(f_0, X_0)$ and itself, 
\[
    I: [0,1] \times M \to  \R: (s, p) \mapsto f_0(p),
\] 
then $\Phi^{I} = \operatorname{Id}$.
So consider $F$ a stationary interpolation between $f_0$ and $f_1$ and $G$, the reverse interpolation from $f_1$ to $f_0$ and $H = I$. Then the induced homological maps $\Phi^{F}$ and $\Phi^{G}$ are inverses of each other.

Let us prove that $\Phi^{G}  \circ  \Phi^{F}$ and $\Phi^{H}$ are chain homotopic.
The idea of this part of the proof is very similar to the first part.
Instead of creating one slide from $f_0$ to $f_1$ by adding an extra dimension, we create a two-dimensional slide with as sides four slides: $f_0 \xrightarrow{F} f_1$, $ f_1 \xrightarrow{G} f_2$, $f_0 \xrightarrow{H}  f_2$ and $ f_2 \xrightarrow{I} f_2$.


More concretely, we create a map
\[
    K: \left[-\tfrac{1}{3}, \tfrac{4}{3}\right] \times \left[-\tfrac{1}{3}, \tfrac{4}{3}\right] \times M \to  \R:  (s, t, p) \mapsto K_{s, t}(p)
,\] 
with the following properties, as illustrated in Figure~\ref{fig:morse-homology-independence-two-dimensional-slide}:
\begin{itemize}
    \item $K_{s,t} = H_t$ for  $s \in \left[-\tfrac{1}{3}, \tfrac{1}{3}\right]$
    \item $K_{s,t} = G_t$ for  $s \in \left[\tfrac{2}{3}, \tfrac{4}{3}\right]$
        \item $K_{s, t} = F_s$ for $t \in \left[-\tfrac{1}{3}, \tfrac{1}{3}\right]$ 
        \item $K_{s,t} = f_2$ for $t \in \left[\tfrac{2}{3}, \tfrac{4}{3}\right]$
\end{itemize}
\begin{marginfigure}
    \centering
    \incfig{morse-homology-independence-two-dimensional-slide}
    \caption{The map $K_{s,t}$ is a two-dimensional homotopy between $f_0, f_1, f_2, f_2$.}
    \label{fig:morse-homology-independence-two-dimensional-slide}
\end{marginfigure}
Note that these properties are not contradictory because we are working with stationary interpolations.

Now, to make a slide, we modify $K$ as follows:
 \[
     \tilde{K}_{s,t}(p) = K_{s,t}(p) + g(s) + g(t)
,\] 

\begin{marginfigure}
    \centering
    \incfig{morse-homology-independence-two-dimensional-slide-three-d}
    \caption{By adding the slide function $g$ in $s$- and $t$-directions, we create a two-dimensional slide, eliminating the possibility of degenerate critical points.}
    \label{fig:morse-homology-independence-two-dimensional-slide-three-d}
\end{marginfigure}

with $g$ defined similarly as before, making $\tilde{K}$ a Morse function with critical points in the yellow regions in the figure.
The points correspond to critical points of $f_0$, $f_1$, $f_2$ and $f_2$ with indices raised by $2, 1, 1, 0$ respectively.
Also similarly as before, we can construct a pseudo-gradient vector field $X$ adapted to $\tilde{K}$, by adding $-\grad g(s)$, $-\grad g(t)$ at the appropriate regions and perturbing it in order to have the Smale property, again making sure that the perturbation is small enough such that $\partial_X = \partial_{\tilde X}$, where $\tilde{X}$ is the perturbed vector field.

While the resulting manifold $[-\frac{1}{3}, \frac{4}{3}]^2 \times M$ does not have a smooth boundary we can still define the Morse complex.
In summary, we have
\[
    C_{k+1}(\tilde{K}) = C_{k-1}(f_0) \oplus C_k(f_1) \oplus C_k(f_2) \oplus C_{k+1}(f_2)
,\] 
and the differential can be written as
\[
\partial_{\tilde{X}} = \begin{pmatrix}
    \partial_0 & 0 & 0 & 0\\
    \Phi^{F} &\partial_1 & 0 & 0 \\
    \Phi^{H} & 0 & \partial_2 & 0 \\
    S & \Phi^{G} & \operatorname{Id} & \partial_2
\end{pmatrix}
.\] 
Now, computing $\partial_{\tilde{X}}^2(p, 0, 0, 0)$ is like water trickling down four spillway bowls, as illustrated in Figure~\ref{fig:morse-homology-independence-partial-squared-zero-bis}. We get that
\[
\Phi^{G}  \circ  \Phi^{F} + \Phi^{H} + S \partial_0 + \partial_1 S = 0
,\] 
or as we are working over $\Z_2$,
\[
    \Phi^{G}  \circ \Phi^{F} - \Phi^{H} = S \partial_0 + \partial_1 S
,\] 
proving that $\Phi^{G}  \circ \Phi^{F}$ and $\Phi^{H}$ induce the same map on the level of homology.
This concludes the proof.
\end{myproof}

\begin{figure*}
    \centering
    \sidecaption{Calculating $\partial^2(p)$.
        On the left $\partial(p)$ is illustrated, and on the right  $\partial^2(p)$.
        Because $\partial^2 = 0$, we find that $\Phi^{G}  \circ  \Phi^{F} + \Phi^{H} + S \partial_0 + \partial_1 S = 0$.
        Considering this over $\Z_2$ implies that $\Phi^{G}  \circ \Phi^{F}$ and $\Phi^{H}$ are chain homotopic.
        \label{fig:morse-homology-independence-partial-squared-zero-bis}
    }
    \vspace*{2cm}
\fullwidthincfig{morse-homology-independence-partial-squared-zero-bis}
\end{figure*}


\filbreak
\section{Morse homology over $\Z$}
In this section, we will define Morse homology over $\Z$.
As is to be expected, this homology theory will be less coarse than the one over $\Z_2$. For example, Morse homology over $\Z_2$ cannot distinguish a torus from a Klein bottle, while homology over $\Z$ can.
The main difficulty in defining homology over $\Z$ is keeping track of signs and orientations.

\begin{definition}[Integral Morse homology]
    Let $f: M \to  \R$ be a Morse function and $X$ an adapted pseudo-gradient satisfying the Smale condition. Define
        \[
            C_k(f, \Z) = \Big\{ \sum_{p \in \Crit_k f} n_p p  \mid n_p \in \Z \Big\}  = \bigoplus_{p \in \Crit_k f} \Z p
        ,\] 
        with differentials
        \begin{align*}
            \partial_{X, k}: C_k &\longrightarrow C_{k-1} \\
            p &\longmapsto \sum_{q \in \Crit_{k-1} f} \NX Xpq q
        ,\end{align*}
        where $\NX X pq$ is the \emph{signed} number of trajectories between  $p$ and $q$.
        The homology of the complex $C_\bullet$ is called the integral Morse homology.
\end{definition}

    The count $\NX X p q$ is defined by orienting  $\L pq$.
    Because $\L pq$ is discrete if the indices of $p$ and  $q$ differ by one, this orientation comes down to assigning a sign to each trajectory in  $\L pq$. We can then define $\NX X p q  = \sigma(\L pq)$ where $\sigma$ adds up the signs of the points in $\L pq$.

    The orientation of $\L pq$ is defined in the following way.
    First choose an (arbitrary) orientation for each of the stable manifolds. This is possible since stable manifolds are diffeomorphic to open disks.
    Orientations of stable manifolds induce co-orientations of unstable manifolds, because $\unstable p \tcap \stable q$ and unstable manifolds are contractible.
    Now, the transverse intersection of an oriented and a co-oriented submanifold is also oriented, hence $\traj pq = \unstable p \tcap \stable q$ is oriented.
    Finally fix an orientation on $\R$.
    Because $\L pq = \traj pq / \R$, the orientation of $\traj pq$ induces an orientation on  $\L pq$.

Moreover, we have the following:\sidecite[p.~ 10]{hutchings2002lecture}
    \begin{prop}
        The space of broken trajectories $\Lb ab$ is orientable.
        If $\Ind a = \Ind b + 2$,  the space $\Lb ab $ is one-dimensional and as oriented manifolds we have
         \[
             \partial \Lb ab = \bigcup_{c \in \Crit_{k-1} f }  \L ac \times  \L cb
        .\] 
    \end{prop}
    
    This allows us to prove that $\partial^2 = 0$, using the fact that the signed number of boundary points of a compact oriented $1$-manifold is always zero.
    \begin{theorem}
        Let $X$ be a pseudo-gradient adapted to a Morse function  $f: M \to  \R$ that satisfies the Smale condition.
        Then the differential $\partial_X$ of the integral Morse complex squares to zero.
    \end{theorem}
    \begin{myproof}
        Let $a$ be a critical point of $f$.
        Then by definition of $\partial$,
        \begin{align*}
            \partial^2(a)
            &= 
            \sum_{b \in  \Crit_{k-2}f}
            \sum_{c \in  \Crit_{k-1}f}
            N_X(a, c) N_X(c, b) \: b.\\
            \shortintertext{By definition of $N_X$,}
            &= 
            \sum_{b \in  \Crit_{k-2}f}
            \sum_{c \in  \Crit_{k-1}f}
            \sigma(\L ac \times \L cb )\:  b\\
            &= 
            \sum_{b \in  \Crit_{k-2}f}
            \sigma\Big( \bigcup_{c \in  \Crit_{k-1}f}
            \L ac \times \L cb \Big)\:  b.\\
            \shortintertext{By definition of $\Lb ab$}
            &= \sum_{b \in  \Crit_{k-2}f} \sigma(\partial \Lb a b)\:  b.
        \end{align*} 
        Now, $\Lb ab$ is an oriented compact  $1$-manifold and hence $\sigma(\Lb ab) = 0$.
        This implies that $\partial^2(a) = 0$.
    \end{myproof}
    \begin{remark}
        While we are free to choose the orientations of $\stable p$, reversing it only changes the sign of $\NX X pq$ and  $\NX X qp$ for any $q$, implying that the Morse homology is independent of the choice of orientation.
    \end{remark}


    Let us end this section with some examples.
    We will illustrate the calculation for the signs of trajectories, and discuss Morse homology of the torus and the Klein bottle both over $ \Z_2$ and $\Z$ to show that working over $ \Z$ can have its advantages.

    \begin{eg}
        Consider the `other sphere' and more specifically $\L pq$ with $p$ and  $q$ as in Figure~\ref{fig:orientation-example} below. 
        We start off with an orientation of $\stable q$ and  $\stable p$.
        To orient  $\traj pq$, we use the orientation of  $\stable p$, which co-orients $\unstable p$, indicated in the figure with the thick black horizontal arrows.
        The orientation of $\traj pq$ is indicated with the vertical arrows tangent to  $\traj pq$ and is defined by requiring that the horizontal and vertical vectors form a positive basis w.r.t.\ the orientation of  $\stable q$.
        Finally, the orientation on $\L pq$ is defined as follows: if the arrows are going up (i.e.\ in the negative time direction), the sign is negative, else it is positive.
        \begin{figure}[H]
    \centering
    \sidecaption{
        Orienting $\L pq$ on the `other sphere'.
    \label{fig:orientation-example}
    }
    \incfig{orientation-example}
\end{figure}
    \end{eg}
    \filbreak
\begin{eg}[Homology of $T^2$ over  $\Z_2$]
    We use the Morse function of Example~\ref{eg:tilted-torus}, where the torus is slightly tilted, as illustrated in Figure~\ref{fig:tilted-torus}, where we also added the graph of the critical points.
    Recall that each edge represents a trajectory connecting two critical points of consecutive index.
    The complex is given by $ \Z_2 \to  \Z_2^2 \to \Z_2$, and because each critical point is connected twice to any other critical point of consecutive index, $\partial_k = 0$ for all $k$. 
    This means that we have
    \[
        \HMf[0]{T^2; \Z_2} = \Z_2 \qquad
        \HMf[1]{T^2; \Z_2} = \Z_2^2 \qquad
        \HMf[2]{T^2; \Z_2} = \Z_2
    .\] 
\end{eg}
\begin{marginfigure}
    \centering
    \incfig{tilted-torus}
    \caption{The height function on a tilted torus is a Morse function giving rise to the illustrated flow lines.
        On the right, an abstract depiction of the critical points and the signed flow lines connecting them.
    }

    \label{fig:tilted-torus}
\end{marginfigure}
\begin{eg}[Homology of the Klein bottle over $\Z_2$]
    \begin{marginfigure}
        \centering
        \incfig{tilted-klein-bottle-over-z}
        \caption{The height function of a tilted Klein bottle immersed in $\R^3$ is a Morse function.
            We have illustrated the flow lines connecting critical points.
            Not considering signs, we get the same complex as for the torus. If we do consider signs, we can distinguish one from another.
        }
        \label{fig:tilted-klein-bottle-over-z}
    \end{marginfigure}
    The Klein bottle $K$ is a non-orientable surface. We cannot embed it in $\R^3$, but the strong version Withney's theorem shows that we are able to immerse it, which is what we have done in Figure~\ref{fig:tilted-klein-bottle-over-z}.
    If we tilt the bottle, the height function $h$ is Morse, and the gradient induced by the standard metric on $\R^3$ is adapted to $h$ and satisfies the Smale condition.
    We have also included the graph of the critical points.
    Disregarding sign differences (which will only be important when discussing the complex over $\Z$), this graph is identical to the one we obtained for $T^2$. We conclude that the Morse homology of $K$ and  $T^2$ over $\Z_2$ are identical:
    \[
        \HMf[0]{K; \Z_2} = \Z_2 \qquad
        \HMf[1]{K; \Z_2} = \Z_2^2 \qquad
        \HMf[2]{K; \Z_2} = \Z_2
    .\] 
\end{eg}

\begin{eg}[Homology of $T^2$ over $\Z$]
    We use the Morse function of Example~\ref{eg:tilted-torus}, where the torus is slightly tilted, as illustrated in Figure~\ref{fig:tilted-torus}.
    We have indicated the chosen orientations as before and have assigned a positive orientation to the single point $\stable d = \{d\}$.
    For each trajectory, the sign has been added, both on the figure and on the graph.

    The complex is given by $\Z \xrightarrow{\partial} \Z^2 \xrightarrow{\partial}  \Z$, and because the signs of the trajectories cancel, $\NX Xpq = 0$ for all $p$ and $q$, so each differential is zero.
    In the end, we have
    \[
        \HMf[0]{T^2; \Z} = \Z \qquad
        \HMf[1]{T^2; \Z} = \Z^2 \qquad
        \HMf[2]{T^2; \Z} = \Z
    .\] 
\end{eg}
\begin{eg}
    We have done the same for the Klein bottle, but notice that this time, the signs do not cancel.
    It is easy to check that $\partial_1 = 0$ and that  $\partial_2$ is defined by  $\partial_2(d) = -2b$, where $a,b,c,d$ are the critical points of $h$ with increasing height.
    This means that $\Im \partial_2 = 2 \Z$. Summarizing, we have
    \[
        \HMf[0]{K; \Z} = \Z \qquad
        \HMf[1]{K; \Z} = \Z \oplus \Z_2 \qquad
        \HMf[2]{K; \Z} = 0
    .\] 
    The conclusion of this series of examples is that integral homology is less coarse than homology over $\Z_2$.
\end{eg}

\filbreak
\section{Morse homology is singular homology}

In the final section of this chapter, we prove that Morse homology is isomorphic to singular homology.
There are many ways to go about this.
Some authors\sidenote[][0cm]{\fullcite[p.110]{audin}} do it by proving that Morse homology is isomorphic to cellular homology, which is in itself isomorphic to singular homology.
This approach consists of two steps: first proving that (suitable compactifications of) unstable manifolds form a cellular decomposition of $M$, and second: proving that the corresponding map is a chain isomorphism.
While the first step is intuitive, a rigorous proof is actually very technical.
The second step on the other hand, is quite straightforward.

To mitigate these technical difficulties, many other authors\sidenote{
    \fullcite[p. 195]{banyaga2013lectures}\\[0.3em]
    \fullcite[p. 13]{hutchings2002lecture}\\[0.3em]
\fullcite[p. 66]{abbondandolo2006lectures}} follow a different approach, based on cellular filtrations, currents and other techniques.
Here we opt for the proof by Hutchings based on currents, also called de Rham homology.
For a thorough introduction on currents, see `Differentiable manifolds' by de Rham.\sidecite{de2012differentiable}

\begin{definition}[Current]
    A current is a continuous linear functional on the space of compactly supported $k$-forms on a manifold $M$.
\end{definition}
\begin{remark}
    One should think of currents as distributions on manifolds. For example, the Dirac delta distribution is a current acting on $0$-forms on $\R$ as follows: $f \mapsto  f(0)$, where $f$ is a $0$-form, i.e.\ a function.
\end{remark}
\begin{eg}
    Any compact manifold (with boundary) $M$ of dimension $n$ defines a current $[M]$ on $n$-forms in the following way:
    \[
        [M](\omega) := \int_M \omega
    .\] 
    For two disjoint submanifolds $M, N$ we have
    \[
        [M \sqcup N] = [M] + [N]
    .\] 
    Notice that by Stokes' theorem,
    \[
        [\partial M](\omega) = \int_{\partial M} \omega = \int_M d \omega = [M](d \omega).
    \] 
    This motivates the following definition:
\end{eg}
\begin{definition}
    We can define a differential on the space of currents by defining
    \[
        (\partial T) (\omega) := T(d \omega)
    .\] 
    When $T = [M]$, this can be written as $\partial [M] = [\partial M]$. 
\end{definition}
This differential clearly squares to zero, and hence defines a complex.
It turns out that its homology is actually isomorphic to singular homology.\sidenote{
    See \fullcite[p.~89, Theorem~16]{de2012differentiable}, or \fullcite[p.~582, Theorem~2]{giaquinta1998cartesian}
}
With this set up, we are ready to prove the following theorem:

\begin{theorem}
    Let $M$ be a closed manifold. Then
     \[
         \HMf[\bul]{M; \Z} = H_{\bul}(M; \Z)
    ,\] 
    where $H_{\bul}(M; \Z)$ denotes the singular homology of $M$.
\end{theorem}

\begin{myproof}
    As stated before, we follow Hutchings.\sidecite{hutchings2002lecture}
    \paragraph{Idea of the proof}
    
    We define two chain maps:
    \begin{align*}
        D: C_\bul &\longrightarrow C_\bul^{\text{c}}(M) \\
         \text{critical point}&\longmapsto [\text{compactification of $\unstable{c}$}]\\
         \shortintertext{and}
        A: C_\bul^{\text{c}}(M) &\longrightarrow C_\bul \\
         \text{generic simplex} &\longmapsto 
         \parbox[t][][t]{5cm}{sum of critical points on which the simplex hangs by flowing via $X$.}
    \end{align*}
\begin{marginfigure}
    \centering
    \incfig{idea-of-the-proof-maps-a-and-d}
    \caption{The map $D$ is defined by mapping a critical point to the current of a compactification of $\unstable c$. The map $A$ maps a generic simplex to the critical points it `hangs on'.}
    \label{fig:idea-of-the-proof-maps-a-and-d}
\end{marginfigure}

    Here we define $C_i^{\text{c}}(M)$ as the subspace of all  $i$-dimensional currents on $M$ generated by \emph{generic} $i$-simplices, by which we mean simplices that are smooth and whose faces are transverse to the stable manifolds of all critical points.


    Then $A  \circ D$ is the identity, and while $D  \circ  A$ is not, it is chain homotopic to the identity.
    The chain homotopy sends a singular chain to its entire forward orbit under the flow of $X$.
    This proves the theorem.

    In summary, we will prove the theorem in $7$ steps:
    \begin{enumerate}
        \item Compactification of $\unstable c$
        \item Definition of $D$
        \item $D$ is a chain map
        \item Definition of $A$
        \item $A$ is a chain map
        \item $A  \circ D = \operatorname{Id}$
        \item  $D  \circ A \cong \operatorname{Id}$
    \end{enumerate}

    \paragraph{1. Compactification of $\bm{\unstable c}$}
    We can compactify $\unstable c$ into a manifold with corners as follows:
     \[
         \unstableb c = \unstable c \cup  \bigcup_{d \neq c} \Lb cd \times  \unstable d
    .\] 
    We have given some examples in Figure~\ref{fig:compactification-of-unstable-manifolds} which make it clear that this compactification possibly differs from the reader's expectations. 
    For example, on top the compactification becomes a closed interval, and not a circle, even though the two end points map to the same point in $M$.
    \begin{marginfigure}
        \centering
        \incfig{compactification-of-unstable-manifolds}
        \caption{
            Two examples of compactifications of unstable manifolds in the `other sphere'.
            On top we consider the index 1 critical point and on the bottom the index 2 critical point.
        Note that the compactifications are subtle  and in particular are not diffeomorphic to $S^{1}$ and $B^{2}$ resp.}
        
        \label{fig:compactification-of-unstable-manifolds}
    \end{marginfigure}
    
    As an oriented manifold, its codimension-$1$ stratum\sidenote{
        The codimension $k$ stratum of a manifold with corners $M$ is the set of points $p$ in  $M$ such that there exists a chart  $f : U(p) \to \R^{n-k} \times [0, \infty)^{k}$ such that at least one of the last $k$ coordinates of $p$ is zero.
        The codimension $0$ stratum is the interior of $M$, the codimension $1$ stratum is its boundary, without the `higher order' corners, etc.
    } is given by
    \[
        \partial \unstableb c = \bigcup_{d \neq c}  (-1)^{\Ind d + \Ind c + 1} \Lb cd \times  \unstable d.
    \]

    \paragraph{2. Defining $\bm{D}$}
    Let $e: \unstableb c \to  M$ be the inclusion extending the inclusion of $\unstable c \to  M$.\sidenote{Note that by previous remarks, this extension is not necessarily injective}
    Then we define the current $D(c) := e_* \left[\unstableb c\right]$, i.e.\ integration over $\unstableb c$:
    \[
        D(c)(\omega) = \int_{\unstableb c} e^{*} \omega
    .\] 
    This current is an element of $C_{\bul}(M)$ because of the Smale condition.

    \paragraph{3. The map $\bm{D}$ is a chain map:  $\bm{\partial D = D \partial^{\text{Morse}}}$}
    We have

    \[
        \partial \unstableb c = \bigcup_{d \neq c}  (-1)^{\Ind d + \Ind c + 1} \Lb cd \times  \unstable d,
    \]
    \begin{marginfigure}
        \centering
        \incfig{d-is-a-chain-map}
        \caption{An example illustrating that $D$ is a chain map.}
        \label{fig:d-is-a-chain-map}
    \end{marginfigure}
    which using the fact that $[M \sqcup N] = [M] + [N]$ implies that
    \[
        \partial D(c) = \sum_{d \neq c} (-1)^{\Ind d + \Ind c + 1} e_*\left[\Lb cd \times  \unstable d\right]
    .\] 
    We have three cases to consider based on the index of $d$:
    \begin{description}
        \item[$\Ind d > \Ind c-1$]: Then $\Lb c d = \O$ by the Smale condition, so these terms vanish.
        \item[$\Ind d = \Ind c-1$]: We get a term of the form \[
            e_* \left[\Lb cd \times \unstableb d\right] = \# \L cd \cdot e_*[\unstable d],\]
            because $\L cd = \Lb cd$ is  $0$-dimensional.
        \item[$\Ind d < \Ind c-1$]: In this case, the term corresponds to a current of dimension less than $\Ind c - 2$, hence zero in $C_{\Ind c - 1}^{c}(M)$.
    \end{description}
    Summarizing, we have
    \begin{align*}
        \partial D(c) &= \sum_{d \in \Crit_{\Ind c - 1} f} \# \L cd \cdot e_* \left[ \unstableb c \right] \\
                      &= D(\partial^{\text{Morse}}(c))
    .\end{align*} 

    \paragraph{4. Defining $\bm{A}$}

    The map $A$ is defined by mapping a generic simplex $\sigma$ to the sum of critical points on which the simplex hangs by flowing via $X$.
    Some examples of this vague definition are illustrated in Figure~\ref{fig:morse-homology-is-singular-homology-defining-map-a}.
    \begin{marginfigure}
        \centering
        \incfig{morse-homology-is-singular-homology-defining-map-a}
        \caption{
            Examples illustrating the definition of $A$.
            From left to right, a $2$, $1$ and  $0$ simplex $\sigma$ and the resulting critical point $A(\sigma)$ indicated in orange.
        }
        \label{fig:morse-homology-is-singular-homology-defining-map-a}
    \end{marginfigure}
    More rigorously, we denote with $\L \sigma d$ the moduli space of gradient flow lines starting in the $i$-simplex $\sigma$ and ending in $d$.
    This space has a natural orientation and furthermore a compactification $\Lb \sigma d$, such that
    \[
    \partial \Lb \sigma d = \Lb {\partial \sigma} d \cup \bigcup_{c \neq d}  (-1)^{i + \Ind d} \L \sigma c \times \L c d
    .\] 
    The dimension of this manifold is $i - \Ind d$, which means that if  $\Ind d = i$,  $\Lb \sigma p = \L \sigma p$ consists of a finite number of points (with signs if we are considering orientation).
    The map $A$ is then defined as
    \[
        A(\sigma) = \sum_{p \in \Crit_i f} \# \L \sigma p p
    ,\] 
    which corresponds to the intuitive definition given earlier.


    \paragraph{5. The map  $\bm A$ is a chain map:  $\bm{A \partial = \partial^{\text{Morse}} A}$}
    We will show that $A \partial = \partial^{\text{Morse}} A$ component by component. To this purpose, we introduce the inner product on the space of critical points, defined on a basis as follows:
    \[
        \left<c, d \right> = \begin{cases}
            1 & \text{if $c = d$}\\
            0 & \text{else.}
        \end{cases}
    \] 
\begin{marginfigure}
    \centering
    \incfig{a-is-a-chain-map}
    \caption{An example where $\sigma$ is a $1$-simplex illustrating that  $A$ is a chain map.}
    \label{fig:a-is-a-chain-map}
\end{marginfigure}

    Let $\sigma$ be a  $i$-simplex and $d \in \Crit_{i-1} f$.
    Then $\dim \Lb \sigma d = 1$, so  $\# \partial \Lb{\sigma}{d} = 0$, with signs taken into account.
    This implies that
    \begin{align*}
        \left<A(\partial \sigma), d \right> - \left<\partial^{\text{Morse}} A (\sigma) ,d\right> &= \# \Lb {\partial \sigma} d - \# \bigcup_{c \in  \Crit_i f} \L \sigma c \times  \L c d\\
                                                                                                 &= \# \partial \Lb \sigma d = 0
    ,\end{align*} 
    showing that $A \partial = \partial^{\text{Morse}} A$.


\paragraph{6. The map $\bm{A}$ is left inverse to $\bm{D}$: $\bm{A  \circ D = \text{Id}}$}
    This immediately follows from the definitions of $A$ and $D$.
    Indeed, $\L {D(c)} c = \{c\}$ and $\L {D(c)} d = \O$ for any other critical point $d$.
\begin{marginfigure}
    \centering
    \incfig{a-is-left-inverse-to-d}
    \caption{The map $A$ forms a left inverse to $D$.}
    \label{fig:a-is-left-inverse-to-d}
\end{marginfigure}


\paragraph{7. The composition $\bm{D  \circ A}$ is chain homotopic to Id}
While clearly $D  \circ  A \neq \operatorname{Id}$, these two maps are chain map homotopic, meaning that there exists a map $F: C_i(M) \to  C_{i+1}(X)$ such that $\partial F + F \partial = D  \circ  A - \operatorname{Id}$.
\begin{marginfigure}
    \centering
    \incfig{d-na-a-is-not-identity}
    \caption{$D  \circ  A \neq  \operatorname{Id}$.}
    \label{fig:d-na-a-is-not-identity}
\end{marginfigure}
\begin{marginfigure}
    \centering
    \incfig{chain-homotopy-between-d-na-a-and-id}
    \caption{A compactification of the forward orbit of a chain $\sigma$ forms a chain homotopy between $\sigma$ and  $(D  \circ  A)(\sigma)$.}
    \label{fig:chain-homotopy-between-d-na-a-and-id}
\end{marginfigure}
Intuitively, a chain homotopy is a chain of one dimension higher that connects $(D  \circ  A)(\sigma)$ and $\operatorname{Id} (\sigma) = \sigma$.
The intuitive choice in this case would be the so-called forward orbit of $\sigma$:
\[
    G(\sigma) := [0, \infty) \times \sigma
,\] with the map $e: G(\sigma) \to  M: (s, x) \mapsto \psi_s (\sigma(x))$.
This set can be compactified to a smooth manifold with boundary
\[
    \partial \overline{G(\sigma)} = - \sigma \cup - G(\partial \sigma) \cup \bigcup_{d}  \L \sigma d \times \unstable d
.\] 
We can extend $e$ to a smooth map and define 
\begin{align*}
    F: C_i^{c}(M) &\longrightarrow C_{i+1}^{c}(X) \\
    \sigma &\longmapsto e_* \left[ \overline{G(\sigma)} \right] 
.\end{align*}
While intuitively, this is a chain map between $\sigma$ and  $(D  \circ A)(\sigma)$, we should check that $\partial F + F \partial = D  \circ  A - \operatorname{Id}$.
Calculating $\partial F$ and  $F \partial$, we have
\begin{align*}
    (\partial F)(\sigma) &= -e_*[\sigma] - e_*[G(\partial \sigma)] + \sum_{d} e_*\left[\L \sigma d \times \unstable d\right]\\
    (F \partial)(\sigma) &= e_*\left[\overline{G(\partial \sigma)}\right]
    .\end{align*}
    When we add this up, $[G (\partial \sigma)]$ and $\left[ \overline{G(\partial \sigma)} \right]$ cancel as currents, leaving us with

    \[
        (\partial F + F \partial)(\sigma) = -e_* [\sigma] +\sum_{d} e_*\left[\L \sigma d \times \unstable d\right].
    \]
    Now, calculating $(D  \circ A - \operatorname{Id})(\sigma)$, we get
    \begin{align*}
        (D  \circ A - \operatorname{Id})(\sigma) &=
        D\left(\sum_d \# \L \sigma d d\right) - e_*[\sigma]\\
        &= \sum_d \# \L \sigma d \cdot D(d) - e_*[\sigma]\\
        &= \sum_d \# \L \sigma d \cdot e_*[\unstableb d] - e_*[\sigma]
    .\end{align*} 
    Keeping in mind that as currents $[\unstableb p] = [\unstable p]$, we find that $D  \circ  A - \operatorname{Id} = \partial F + F \partial$.
\end{myproof}

