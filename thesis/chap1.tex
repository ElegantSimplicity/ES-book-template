\chapter{Morse theory}

When studying manifolds is often proves useful to study simple structures that live on them. For example, studying differential forms gives rise to the de Rham cohomology, which tells us something about the global structure of the manifold. In this thesis, we study some of the most simple maps: maps from the manifold $M$ to $\R$. A prototypical example of such a map is a projection.
While these projections seem to lose much information, we will see that they actually can provide great insight in the structure of the manifold itself.

\section{Definition of a Morse function}

We will not consider arbitrary maps $M \to \R$, but rather maps that have nice behaviour at their critical points. Let us first recall what a critical point is.

\begin{definition}[Critical point]
    Let $M$ and $N$ be a manifolds and  $f$ a map from $M$ to $N$.
    The critical points of $f$ is the set given by
    \[
    \Crit f = \{p \in M  \mid \text{$df_p$ is not surjective}\} 
    .\] 
    In particular, if $N = \R$ we have that
    \[
    \Crit f = \{ p \in M  \mid  df_p = 0\} 
    .\] 
\end{definition}
The maps we will be considering are then characterised as follows:
\begin{definition}[Morse function]
    Let $M$ be a manifold. A function $f: M \to  \R$ a \emph{Morse function} if for all critical points $p$, there exists a chart centred around $p$ such that $f$ is locally given by
    \[
        f(x) = f(p) -x_1^2 - \cdots - x_k^2 + x_{k+1}^2 + \cdots + x_n^2
    .\] 
    We call such a chart a \emph{Morse chart} and we call $k$ the index of $p$, which we also denote with $\Ind p$.
    
\end{definition}
Intuitively, the index of a critical point $p$ is ``the number of downward directions''.
Let us first give some examples.
\begin{marginfigure}
    \centering
    \incfig{examples-of-morse-functions}
    \caption{Example of a Morse function on the torus. At each critical point, the index $k$, the number of downward directions is indicated. }
    \label{fig:examples-of-morse-functions}
\end{marginfigure}
\begin{eg}
    Let $M$ be the torus  $T^2$ embedded in $\R^3$ as illustrated in Figure~\ref{fig:examples-of-morse-functions}.
    Then the height function $h: T^2 \to  \R$ which is the projection on the $z$-axis is a Morse function with four critical points:
    \begin{itemize}
        \item A minimum $p$, where $h(x) = h(p) + x_1^2 + x_2^2$.
        \item Two saddle points $s_1, s_2$ where $h(x) = h(s_i) + x_1^2 - x_2^2$.
        \item A maximum $q$ where $h(x) = h(q) - x_1^2 - x_2^2$.
    \end{itemize}
\end{eg}

\begin{noneg}
    Let $M = \R^2$ and $f: \R^2 \to  \R: (x, y) \mapsto  x^2$.
    Then all points $(0, y)$ for  $y \in \R$ are critical points of this function.
    In particular, $(0, 0)$ is a critical point. Locally, we cannot write $f$ as  $ \pm x_1^2 \pm x_2^2$ for some coordinates $(x_1, x_2)$, so $f$ is not Morse.
\end{noneg}
\begin{marginfigure}
    \centering
    \incfig{non-example-of-morse-function}
    \caption{}
    \label{fig:non-example-of-morse-function}
\end{marginfigure}
\begin{marginfigure}
    \centering
    \incfig{non-examples-of-morse-functions}
    \caption{An example of a function that is not Morse: $f: \R \to  \R: x \mapsto  x^3$.
        Small perturbations of $f$ are Morse.
    }
    \label{fig:non-examples-of-morse-functions}
\end{marginfigure}
\begin{noneg}
    Let $M = \R$ and $f : \R \to  \R: x \mapsto x^3$.
    Then $x = 0$ is a critical point, but $f$ is not Morse.
    Note however that if we add a small perturbation to $f$, say $g_t: x\mapsto x^3+ tx$, then for small non-zero $t$, $g$ is Morse. For $t < 0$, $g_t$  has two critical points: one of index $1$ and one of index $0$.
    If $t > 0$,  $g_t$ has no critical points.
\end{noneg}

Note that this last case where $f$ has no critical points cannot happen if $M$ is compact.
Indeed, any function attains it maximum and minimum on a compact manifold, so we have at least two critical points.
On the other hand, the number of critical points is at most finite.
This is because of the definition of a Morse function: it implies that critical points are isolated, which on a compact manifold implies that their number is finite.
This also immediately rules out the situation we had in the other example, where the set of critical points was a straight line.

\section{Coordinate-free definition of a Morse function}

The attentive reader will have noticed that the definition of the index of a critical point could possibly not be well defined.
To show that it is and that $\Ind p$ does not depend on the choice of coordinates, we will will give a coordinate-free definition. For this, we first need to define the Hessian at a critical point.

\begin{definition}
    Let $M$ be a manifold and $f: M \to  \R$ a function.
    Let $p$ be a critical point of $f$.
    Then we define the Hessian $H_p$ to be the bilinear form
    \begin{align*}
        H_p: T_pM \times T_pM &\longrightarrow  \R\\
        (X, Y) &\longmapsto X (\tilde{Y} f)|_p
    ,\end{align*} 
    where $\tilde{Y}$ is a local extension of $Y$ around $p$.
\end{definition}
This is a well defined symmetric bilinear form.\sidenote{The difference between $H_p(X, Y)$ and  $H_p(Y, X)$ is given by
\begin{align*}
    H_p(X, Y) - H_p(Y, X) &= X(\tilde{Y} f)|_p - Y (\tilde{X} f)|_p\\
                          &= [\tilde{X}, \tilde{Y}] f |_p\\
                          &= df_p [\tilde{X}, \tilde{Y}]|_p = 0
.\end{align*}
The value of $H_p$ also does not depend on the extension of the vector field.
Indeed, suppose $\tilde{Y}$ and $\overline{Y}$ are two different extensions of $Y$. Then by symmetry of $H_p$, we have
\[
    X(\tilde{Y} f)|_p = Y(\tilde{X} f)|_p = X(\overline{Y}f )|_p
.\] 
This also shows linearly of the second component.
}
In case of a Morse function given locally by $f(x) = f(p) - x_1^2 - \cdots - x_k^2 + x_{k+1}^2 + \cdots + x_n^2$, the Hessian at $p$ is 
\[
    H_p = 2(- dx_1^2 - \cdots - dx_k^2 + dx_{k+1}^2  + \cdots + dx_n^2)
,\] 
where $dx_i^2 = dx_i \otimes dx_i$.
Note in particular that $H_p$ is non-degenerate and its signature is $(i_-, i_{+}) = (k, n-k)$, as we have $k$ negative eigenvalues, $n-k$ positive eigenvalues.
As the signature of a symmetric bilinear form is coordinate independent, this shows that the index of a critical point is as well.


Interestingly, the reverse is also true: if $H_p$ is non-degenerate for all critical points  $p$ of $f$, then  $f$ is a Morse function.
Many authors take this to be the definition of a Morse function.

\begin{lemma}[Morse Lemma]
    Let $M$ be a manifold and $f: M \to  \R$ a smooth map.
    If for all $p \in \Crit f$, the Hessian $H_p$ is non-degenerate, then $f$ is Morse.
\end{lemma}
\begin{proof}
    We follow the proof of Milnor\sidecite[6]{milnor}.
    We may assume that $M = \R^{n}$, $p$ is the origin and $f(p) = 0$.
    Then by a version of Taylor's theorem, we can write
    \begin{align*}
        f(x)  &= f(p) + \sum_{i=1}^{n} (x_i - p_i) g_i (x)\\
              &= \sum_{i=1}^{n} x_i g_i(x)
    ,\end{align*} 
    where $g_i$ are smooth functions. 
    Now, as $g_i(0) = \partial_i f (0) = 0$, we can repeat this for each  $g_i$, giving us the following:
    \[
        f(x) = \sum_{i, j= 1}^{n} x_i x_j h_{ij}(x)
    .\] 
    Because this sum is symmetric in $i$ and  $j$, we may assume that  $h_{ij}$ is symmetric as well.\sidenote{If $h_{ij}$ is not symmetric, we can replace it by $h_{(ij)} = \frac{1}{2}(h_{ij} + h_{ji})$. Then $h_{(ij)}$ is symmetric and we still have $\sum x_{i}x_{j}h_{ij} = \sum x_{i}x_{j}h_{(ij)}$.}
    Note that
    \[
        h_{ij}(0) = \frac{1}{2} \partial_{ij} f(0)
    ,\]
    which is non-degenerate by assumption.

    Now we imitate the proof of diagonalization of a non-degenerate quadratic form.
    We do this by induction.
    Suppose we have coordinates $u_1, \cdots, u_n$ in a neighbourhood of $0$ such that
    \[
        f = \pm u_1^2 \pm \cdots \pm u_{r-1}^2 + \sum_{i,j\ge r} u_i u_j H_{ij}(u)
    ,\] 
    where $H_{ij}$ is a symmetric matrix.
    After a linear change, we may assume by non-degeneracy that $H_{rr} \neq 0$.
    Then define new coordinates $ v_1, \ldots, v_r$ as follows:
    \[
        v_i = \begin{cases}
            u_i & \text{if $i \neq r$}\\
            \sqrt{|H_{rr}|} (u_r + \sum_{i > r} u_i H_{ir} / H_{rr}) & \text{if $i = r$.}
        \end{cases}
    \] 
    Note that we may need to restrict the neighbourhood such that $\sqrt{H_{rr}} \neq 0$.
    Then we have that
    \[
        f = \sum_{i\le r} \pm v_i^2 + \sum_{i,j > r} v_i v_j H_{ij}'(v)
    .\] 
    for some symmetric matrix $H_{ij}'$.
    \todo{Explain better}
    % Indeed,
    % \begin{align*}
    %     v_r^2 &= |H_{rr}| \left(u_r^2 + \sum_{i>r} 2 u_r u_i H_{ir} / H_{rr} + \left(\sum_{i>r} u_i H_{ir} / H_{rr}\right)^2\right)\\
    %           &= TODO
    % .\end{align*} 

\end{proof}

\section{Handle decompositions}
\todo{Introduction}

\todo{Check definition Milnor $h$-cobordism and fix definition Morse function}
\begin{definition}
A cobordism between two compact manifolds $M_1$ and $M_2$ is a compact manifold $M$  with boundary $\partial M = M_1 \sqcup M_2$.
\end{definition}


The term `cobordism' comes from the fact that $M_1 \sqcup M_2$ are the boundary of $M$, so we can think of $M$ as the `co-boundary' of $M_1$ and $M_2$.
Cobordisms are an interesting topic in their own right.
For example, they define an equivalence relation on all compact manifolds of same dimension. Two manifolds $ M_1$ and $M_2$ are then said to be equivalent (cobordant) if there exists a cobordism $M$ connecting the two.
This equivalence relation is coarser than diffeomorphism and is generally easier to study.
Cobordisms also form a category where the objects are manifolds and the arrows are cobordisms.

We have illustrated some examples below.
Note that we may also take $M_1$ or $M_2 = \O$.
In particular, any closed manifold is a cobordism from $\O$ to $\O$.
\begin{figure}[H]
    \centering
    \sidecaption{Some examples of cobordisms. 
        When the height function has a critical point, the topology changes from top to bottom.
    \label{fig:examples-of-cobordisms} }
    \incfig{examples-of-cobordisms}
\end{figure}

When we consider the height function $f: M \to  [0, 1]$ on these examples,
we observe that the topology of the bottom is different than that of the top if the height function has critical points.
This is indeed in general true.
If $f$ is a Morse function (as is the case in our examples), it will turn out we can very concretely describe \emph{how} this topology changes.
This will give rise to the concept of handle decompositions.

\newthought{Let us first consider} the case where $f: M \to [0, 1]$ has no critical points. 
For simplicity, we introduce the following refined definition of a Morse function on a cobordism:
\begin{definition}[Morse function on a cobordism\sidenotemark]
    Let $M$ be a cobordism from $M_0$ to $M_1$.
    A function $f: M \to  [a, b]$ is said to be \emph{Morse} if 
    \begin{itemize}
        \item $M_0 = f^{-1}(a)$, $M_1 = f^{-1}(b)$
        \item All critical points lie interior in $M$ and are non-degenerate.
    \end{itemize}
\end{definition}
\sidenotetext{\fullcite[8]{hcobord}}

\begin{prop}
    Suppose $f: M \to  [a, b]$ is a Morse function on a cobordism $M$ from  $ M_0$ to $ M_1$.
    If $f$ has no critical points, then $M$ is diffeomorphic to $[a, b] \times  M_0$.
\end{prop}
\begin{proof}
    \todo{Check proof $h$-cobordism milnor}
    \begin{marginfigure}
        \centering
        \incfig{proof-of-cobordism-without-critical-points}
        \caption{
            When a cobordism has no critical points, it is diffeomorphic to a product manifold. }
        \label{fig:proof-of-cobordism-without-critical-points}
    \end{marginfigure}
    Consider a Riemannian metric $\left<\cdot ,\cdot  \right>$ on $M$.
    Because  $f$ has no critical points, the vector field $W = (df)^{\sharp}$ never vanishes.\sidenote{Here and hereafter, we use $\sharp$ and $\flat$ for the `musical isomorphisms' induced by metric $\left< \cdot, \cdot \right>$, given by
        \begin{align*}
            \flat: TM \longrightarrow T^*M: &\:X \longmapsto X^{\flat} = \left<X, - \right>\\
            \sharp: T^*M \longrightarrow TM :&\:\alpha \longmapsto \alpha^{\sharp}
        ,\end{align*}
        where $\alpha^\sharp$ is uniquely defined by $\langle\alpha^\sharp, X\rangle = \alpha(X)$.
    }
    Consider the normalized vector field
    \[
    V = \frac{1}{\left<W, W \right>} W
    .\] 
    Then $df(V) = \frac{1}{\left<W, W \right>} df(W) = 1$.
    Consider
    \begin{align*}
        \phi: [0, 1] \times M_0&\longrightarrow M \\
        (t, p) &\longmapsto \theta_V^{t}(p)
    ,\end{align*}
    where $\theta_V^{t}$ is the flow along $V$.
    Then $f(\phi(t, p)) = t$ for all $p \in M_0$, as $df(V) = 1$.
    The map $\phi$ is injective because of the uniqueness of flows, and surjective because given a point $p$ in $M$, we can always flow back along $V$ for a time $t$ to find a $p_0 \in M_0$ which then satisfies $\phi(t, p_0) = p$. 
    This also proves that $\phi$ is a diffeomorphism.
\end{proof}
This result is very useful and is sometimes used to prove that two manifolds $M_0$ $M_1$ are diffeomorphic: if we can construct a cobordism from $M_0$ to $M_1$ and we can prove the existence of a Morse function without critical points, then $M_0 \cong M_1$.


\todo{Corollary: collar and bicollar theorem. Milnor $h$-coboridsm.}
\todo{Corollary: we can glue two cobordisms together and get a manifold un a unique way. Milnor $h$-coboridsm.}

In the case in which $f$ does have a critical point $p$, the previous proof fails because $d_pf = 0$, so $\grad f = (df)^{\sharp}$ vanishes at some point.


\newthought{Let us now investigate} the situation when a Morse function $f$ does have a single critical point, say $p$ and assume $f(p) = 0$.
Then we know $f$ is locally of the following form:
\[
    f(x_1, \ldots, x_n) = - x_1^2 - \cdots - x_k^2 + x_{k+1}^2 + \cdots + x_n^2
.\] 
In Figure~\ref{fig:morse-chart}, we have plotted the first $k$ variables (the `downward directions') on the horizontal axis, and the last $n-k$ variables on the vertical axis.
Then the level set $f^{-1}(0)$ is given by
\[
x_1^2 + \cdots + x_k^2 = x_{k+1} ^2 + \cdots + x_n^2
,\] 
which consists of the two crossing lines in the figure, corresponding to the crossing part of the figure-eight on the right.
Level sets of values slightly above an below $0$ look locally like hyperbolas on our figure, but remembering that that the axes consist of multiple dimensions, it would be more precise to call them hyperboloids.

\todo{Add figure movie: two hyperbolas switching, hyperboloids, one handle in three dimensions that joins, \ldots}
\begin{figure}[H]
    \centering
    \sidecaption{Around a critical point of a Morse function, we can find a chart as on the left. The dark region corresponds to $f(x) < 0$, the light region to $f(x) >0$. The level set $f^{-1}(0)$ is not a manifold.
    \label{fig:morse-chart}}
\incfig{morse-chart}
\end{figure}

To contain the behaviour of the critical point, it is useful to cut out the area bounded by the level sets $f = \pm \epsilon$ in order to make it compact.\todo{wording}.
A natural way to do this, is to cut along gradient flow lines of $f$ (Figure~\ref{fig:morse-chart-flow-lines} and \ref{fig:morse-chart-zoomed-in}).
Of course, a gradient is only defined when we have a metric, and here we choose to use the standard metric on $\R^{n}$.\sidenote{More explicitly, if $f$ is Morse, we know that locally around a critical point $p$, $f$ is given by
    \begin{align*}
        f(x_1, \ldots, x_n) &= f(p) - x_1^2 - \cdots - x_k^2\\
                            & \qquad + x_{k+1}^2 + \cdots + x_n^2
    .\end{align*} 
    Then the negative gradient of $f$ w.r.t.\ the standard metric on $\R^n$ is
    \begin{align*}
        - \grad f &= 2 x_1 \partial_{1} + \cdots + 2 x_k \partial_{k}\\
                & \qquad - 2 x_{k-1} \partial_{k-1} - \cdots - 2 x_n \partial_{n},
    \end{align*}
    where $\partial_i = \partial_{x_i}$.
} In Morse theory it is also customary to consider the negative gradient instead of the standard one.
\begin{marginfigure}
    \centering
    \incfig{morse-chart-flow-lines}
    \caption{A Morse chart with negative gradient flow lines added.
    The coloured area represents a handle. Its boundary consists of parts of level sets of $f$ and flow lines of $\grad f$.}
    \label{fig:morse-chart-flow-lines}
\end{marginfigure}
In Figure~\ref{fig:morse-chart-zoomed-in}, the cut out area is coloured in yellow.
The advantage of cutting along gradient flow lines, is that we have split up the cobordism in three parts which we understand well:
\begin{marginfigure}
    \centering
    \incfig{morse-chart-zoomed-in}
    \caption{A cobordism with one critical point splits up in product structures and a handle.}
    \label{fig:morse-chart-zoomed-in}
\end{marginfigure}
\begin{itemize}
    \item[\circled{A}] The part below $-\epsilon$ and the part above $\epsilon$ have a product structure, because we assumed the only critical value was $0$.
        We can simply repeat the proof above.
    \item[\circled{B}] The part of $M$ that lies between $-\epsilon$  and $\epsilon$ without $\circled{H}$ also has a product structure.
        To see this, extend the metric on $\circled{H}$ to the whole manifold. Then, because $f$ has no critical values outside $\circled{H}$, we can flow along gradient lines giving us a product structure.
        This is why we cut in this way: we want the boundary of this region to consist of gradient lines, or the proof would fail.

        Riemannian metrics are an extension of standard metrics around critical points are called adapted Riemannian metrics.
        Using a partition of unity argument, one can show any manifold admits such metrics.
        \begin{definition}[Adapted Riemannian metric]
            A Riemannian  metric is called \emph{adapted} to a Morse function $f$ if near all its critical points $p \in \Crit f$, the metric is locally, in each Morse chart given by
            \[
            \left<
            (x_1, \ldots, x_n), 
            (y_1, \ldots, y_n)
            \right> = \sum x_i y_i
            .\] 
        \end{definition}
        In most cases, we often forget about the metric itself and simply consider vector fields which are gradient-like.

        \begin{definition}[Pseudo-gradient]
            Let $f: M \to  \R$ be a Morse function on a manifold $M$. A pseudo-gradient is a vector field $X$ such that
            \begin{itemize}
                \item $df(X) \le 0$ and $df(X) = 0$ only at critical points
                \item $X$ coincides in Morse charts with the usual negative gradient for the standard metric on $\R^{n}$.
            \end{itemize}
        \end{definition}




    \item[\circled{H}]  The yellow part is what we call a \emph{handle of index $k$}, and is homeomorphic to $\disk{k} \times \disk{n-k}$.
        This is the only non-trivial part of our cobordism.
        We call the bottom part of the border the \emph{attachment region}, which is homeomorphic to $S^{k-1} \times \disk{n-k}$.
\end{itemize}






\newthought{If a Morse function} on a cobordism has multiple critical points, then we can always assume that the critical values are distinct and isolated.
We can do this by adding a small perturbation to $f$.\todo{prove this}.
Then we can split up the cobordism in parts having only one or zero critical points, and decompose each part in products and handles like before.

As any closed manifold can be viewed as a cobordism from $\O$ to $\O$, we have proved the following:

\begin{theorem}
    Any closed manifold has a handle decomposition.
\end{theorem}

Before discussing some examples, let us first discus some of the different ways to look at handles.
\todo{Add subtleties about corners, \ldots
Thickened up intervals.
Instead of having morse function and decomposing, you can also ask question how you can build a manifold?

Embed attachment region in the manifold you already have.}


\subsection*{Handles in low dimensions}

In this section, we will consider some examples of handle decompositions in dimension one, two and three.

\newthought{Handles in dimension one} are the most simple ones. We only have two types:

\begin{description}
    \item[0-handle] $\disk0 \times \disk{1} = [-1, 1]$, with attachment region $\O$. \hfill \minifig{1cm}{handle-1-0} 
        
    \item[1-handle]   $\disk{1} \times  \disk{0} = [-1, 1]$ with attachment region $S^{0} = \{-1, 1\}$.  \hfill \minifig{1cm}{handle-1-1}
\end{description}

\begin{eg}
    In Figure~\ref{fig:one-dimensional-handle-decomposition-examples}, two handle decompositions of $S^{1}$ are illustrated.
    The first one is based on the height function $f$ when embedding $S^{1}$ in $\R^2$.
    For the second decomposition, $g$ is again defined as a height function, but this time we embedded $S^{1}$ in $ \R^2$ in a non-standard way.
    This way, we get two different handle decompositions of the same manifold.
\end{eg}
\begin{figure}[H]
    \centering
    \sidecaption{Two handle decompositions of $S^{1}$.
    \label{fig:one-dimensional-handle-decomposition-examples}}
    \incfig{one-dimensional-handle-decomposition-examples}
\end{figure}
This example illustrates that handle decompositions are not unique.
However, we can construct an isotopy from the second to the first embedding that cancels the two critical points.
Interestingly, the height function is Morse for all $t$, except at the exact moment when the cancellation happens.
A local model for this is $t\mapsto x^3 + tx$ as in Figure~\ref{fig:non-examples-of-morse-functions}.
\begin{figure}[H]
    \centering
    \sidecaption{There exists an isotopy between the two handle decompositions described above.
    \label{fig:isotopy-between-circle-and-other-circle}}
    \incfig{isotopy-between-circle-and-other-circle}
\end{figure}


\paragraph{Handles in dimension two}
In dimension two, things get more interesting.
We have three types of handles:
\todo{Mention somewhere homology group changes when adding handles. But handle decomposition is not unique, if we could mod out these critical points which can cancel, then it is unique? Giving rise to Morse complex.}

\begin{description}
    \item[0-handle] $\disk{0} \times \disk{2}$ with attachment region $\O$. \hfill \minifig{1cm}{handle-2-0}
    \item[1-handle] $\disk{1} \times \disk{1}$ with attachment region $\disk1 \times S^{0}$. \hfill\minifig{1cm}{handle-2-1}
    \item[2-handle] $\disk{2} \times \disk{0}$ with attachment region $\disk{0} \times S^1$. \hfill\minifig{1cm}{handle-2-2}
\end{description}

\begin{eg}[Handle decomposition of the torus]
    Consider the height function on the torus embedded in $\R^3$. This Morse function gives rise to the handle decomposition in Figure~\ref{fig:handles-in-dimension-two-torus-decomposition}: a $0$-handle, two $1$-handles and one $2$-handle.
\end{eg}

\begin{marginfigure}
    \centering
    \incfig{handles-in-dimension-two-torus-decomposition}
    \caption{The standard embedding of the torus in $\R^3$ gives rise to a handle decomposition consisting of one  0-handle, two 1-handles and three 2-handles.}
    \label{fig:handles-in-dimension-two-torus-decomposition}
\end{marginfigure}

\begin{eg}[The `other sphere']
    In Figure~\ref{fig:handles-in-dimension-two-other-sphere}, an embedding of $S^2$ in $\R^3$ is given, and we again consider the height function.
    This function is Morse, and gives rise to a handle decomposition with a $0$-handle, a $1$-handle and two $2$-handles.
\end{eg}
\begin{marginfigure}
    \centering
    \incfig{handles-in-dimension-two-other-sphere}
    \caption{Embedding $S^2$ in $ \R^3$ in an unusual way gives rise to a handle decomposition with one 0-handle, one 1-handle and two 2-handles. }
    \label{fig:handles-in-dimension-two-other-sphere}
\end{marginfigure}



\paragraph{Handles in dimension three}

\todo{Mention that sometimes you cannot attach handle before other one. When \emph{is} it possible? Hint to descending manifold, \ldots}

\begin{description}
    \item[0-handle] $ \disk0 \times \disk{3}$ with attachment region $\O$ 
        \hfill\minifig{1cm}{handle-3-0}
    \item[1-handle] $ \disk1 \times \disk{2}$ with attachment region $ \disk2 \times S^{0}$
        \hfill\minifig{1cm}{handle-3-1}
    \item[2-handle] $ \disk2 \times \disk{1}$ with attachment region $ \disk1 \times S^1$
        \hfill\minifig{1cm}{handle-3-2}
    \item[3-handle] $ \disk3 \times \disk{0}$ with attachment region $S^{2}$
        \hfill\minifig{1cm}{handle-3-3}
\end{description}

Drawing three-dimensional handle decompositions is a bit harder. Most of the times we suppress the $0$-handle, and also the $3$-handle is not drawn. If a $3$-handle is to be attached, we usually write ``$\cup $ $3$-handle''

\begin{eg}[Handle decomposition of $S^{3}$]
    Consider $S^{3} \subset \R^{4}$ and the height function $f$, the projection on the last coordinate.
    Then $f$ has two critical points: $(0, 0, 0, \pm 1)$ of index $0$ and $3$.
    Then handle decomposition is then a $0$-handle ($\disk{3}$) glued to a $3$-handle (which is also diffeomorphic to $\disk{3}$).
\end{eg}

\begin{eg}[Handle decomposition of $ S^1\times S^{2}$]
    An example of a handle decomposition of $S^{1} \times S^{2}$ is illustrated in Figure~\ref{fig:handles-in-dimension-three-s1-x-s2}.
    The construction starts with a $0$-handle, which is just a three dimensional ball.
    Then we glue on a $2$-handle.
    The resulting manifold is then a thickened-up \todo{spelling}  two sphere, $I \times S^{2}$.
    Then we add a $1$-handle connecting the inside to the outside and we cap of with a $3$-handle, which has the effect of identifying the end points of $I$, i.e. this transforms  $I \times S^{2}$ into $ S^1 \times S^{2}$.
\end{eg}
\begin{marginfigure}
    \centering
    \incfig{handles-in-dimension-three-s1-x-s2}
    \caption{Top: $ S^1 \times S^{2}$ can be decomposed using a 0-handle, 1-handle, 2-handle and 3-handle.
        Bottom: same handle decomposition, but drawn differently to show that  a 0-handle and a 1-handle are diffeomorphic to $S^{2} \times [0,1]$.
}
    \label{fig:handles-in-dimension-three-s1-x-s2}
\end{marginfigure}

\begin{eg}
    \todo{Example of a $1$ and $2$-handle that collapse. }
\end{eg}
\begin{eg}[$T^{3} = S^{1} \times S^{1} \times S^{2}$]
    \label{eg:handle-decomposition-three-torus}
    To find a handle decomposition of $T^3$, we identify $T^{3}$ with $\R^3 / \Z^{3}$ and consider the following map
    \begin{align*}
        f: T^{3} &\longrightarrow \R \\
        (x, y, z) &\longmapsto 2\cos (2 \pi x) + 3\cos ( 2 \pi y) + 4 \cos(2 \pi z)
    .\end{align*}
    Then we have
    \[
        df =
        -4\pi \sin (2 \pi x) dx
        -6 \pi \sin ( 2 \pi y) dy
        - 8 \pi \sin(2 \pi z) dz
    ,\] 
    so critical points are all $(x, y, z) \in \R^3 / \Z^3$ for which  $x, y, z \in \left\{\Z, \frac{1}{2} + \Z\right\}$.
    In total we have $8$ distinct critical points, and they all are non-degenerate, because the Hessian of $f$, given by
    \[
        H_{(x, y, z)} f =
        - 8 \pi^2  \cos (2 \pi x) dx^2
        -12\pi^2 \cos ( 2 \pi y) dy^2
        -16 \pi^2 \cos(2 \pi z) dz^2
    \] 
    is non-degenerate at each of the critical points.
    To find the handle decomposition induced by $f$, we have to determine the index of the critical points.
    As discussed earlier, the index is the number of downward directions, which is also equivalent to the number of negative eigenvalues of $H_{(x, y, z)}f$.
    As $\cos(2 \pi \frac{1}{2}) < 0$ and $\cos(2 \pi 0) > 1$, we find that the index of a critical point $(x, y, z)$ is the number of zeros occurring in the triplet $(x, y, z)$. Hence, we get the following table:
    \[\begin{array}{cccccc}
  & x & y  & z & f(x, y, z) & \text{Index}\\ \hline
  & 0 & 0 & 0 & 9 & 3 \\
& \frac{1}{2} & 0 & 0 & 5 & 2 \\
& 0 & \frac{1}{2} & 0 & 3 & 2 \\
& 0 & 0 & \frac{1}{2} & 1 & 2 \\
& \frac{1}{2} & \frac{1}{2} & 0 & -1 & 1 \\
& \frac{1}{2} & 0 & \frac{1}{2} & -3 & 1 \\
& 0 & \frac{1}{2} & \frac{1}{2} & -5 & 1 \\
& \frac{1}{2} & \frac{1}{2} & \frac{1}{2} & -9 & 0 \\
    \end{array}\]
    We conclude that we can decompose $T^3$ in one $0$-handle, three $1$-handles, three $2$-handles and one $3$-handle.

    A natural question that arises is: `Can we build $T^{3}$ using less handles'?
    \todo{Mention that values of critical points are not distinct}


    \todo{Explain and make full page width}
    \begin{figure}[H]
    \centering
    \incfig{three-torus-handle-decomposition}
    \caption{
        Step by step construction of $T^{3}$ adding one handle at the time.
        Here, $T^{3} = \R^3/ \Z^3$, and $\left[-\frac{1}{2}, \frac{1}{2}\right]^3$ is drawn.
        The construction starts with a $0$-handle.
        In the first three steps, a $1$-handle is added.
        In the consequent steps,
        three holes are filled with $2$-handles,
        leaving us with a single void we fill up with a $3$-handle.
    }
    \label{fig:three-torus-handle-decomposition}
\end{figure}
\end{eg}




\section{Existence and abundance of Morse functions}
One might think that Morse functions are very specific functions and hence they form a small subset of all smooth maps $M \to  \R$.
In this section we show that this is not the case. We will show that any manifold admits uncountably many Morse functions and that the set of Morse function form a dense subset of all smooth maps $M \to  \R$.

Let us first recall the following result, due to Withney\sidecite{todo}.
\begin{theorem}[Withney Embedding Theorem]
    Any smooth manifold $M$ of dimension $m$ can be embedded into  $\R^{2m+1}$
\end{theorem}
This allows us to assume that $M$ is diffeomorphic to a submanifold $V$ of $\R^{n}$, making the constructions  more straightforward.
The following theorem says that there is an abundance of Morse functions on any manifold.
\begin{marginfigure}
    \centering
    \incfig{level-sets-of-distance-function-torus}
    \caption{An embedding of the torus $T^2$ in $\R^3$. The level sets of $f_p$ are spheres. We see that $f_p$ has four critical points: a maximum, a minimum and two saddle points.}
    \label{fig:level-sets-of-distance-function-torus}
\end{marginfigure}
\begin{prop}
    Let $V \subset \R^{n}$ be a submanifold.
    Then for almost every point $p \in \R^{n}$, we have that
    \[
    f_p : V \to \R: x \mapsto  \|x - p\|^2
    \] 
    is a Morse function.
\end{prop}


First, let us give an example of when $f_p$ is \emph{not} a Morse function.

\begin{marginfigure}
    \centering
    \incfig{example-when-fp-is-not-a-morse-function}
    \caption{When $p$ is the center of a circle, $f_p$ is not a Morse function}
    \label{fig:example-when-fp-is-not-a-morse-function}
\end{marginfigure}
\begin{eg}
    Let $V = S^1 = \{\|x\|^2 = 1  \mid  x \in \R^2\} $.
    Then $f_{(0, 0)}$ is not a Morse function.
    Indeed, $f_{(0, 0)} \equiv 1$, so in particular the second derivative is non-degenerate (it vanishes everywhere).
\end{eg}


More generally, $f_p$ is not a Morse function when infinitesimally close normals intersect in $p$, because then $f_p$ is constant up to second order (\todo{in a certain direction \ldots }).
To make this exact, we will show that $H_p$ is non-degenerate if $p$ is a critical value of the map
\[
    E: NV \to  \R^{n}: (x, v) \mapsto x + v
,\]
where $N$ is the normal bundle of $V$.
Then Sard's theorem\sidecite{todo} will immediately imply that $f_p$ is Morse for almost all $p$.

\begin{figure}[H]
    \centering
    \sidecaption{
        Visualization of the normal bundle of $V$, a submanifold of $\R^n$, and the map $E$ used in the proof.
    }
    \incfig{existence-of-morse-functions-normal-bundle-map}
    \label{fig:existence-of-morse-functions-normal-bundle-map}
\end{figure}

\begin{proof}
    Given this insight, the proof now reduces to a straightforward calculation.
    First note that $x$ is a critical point of $f_p$ only if $x-p \perp T_x V$.
    Indeed:
    \[
        d f_p = \sum d(x_i - p_i)^2 = 2 \sum (x_i-p_i) dx_i = 0 \qquad \text{if $x-p \perp T_x V$}
    .\] 
    Let $d = \dim V$ and $(u_1, \ldots, u_d) \mapsto x(u_1, \ldots, u_d)$ be a local parametrization of $V$.
    Then we have
    \[
        \partial_i f_p = 2(x-p) \cdot  \partial_i  x
    \] 
    and for the hessian we have
    \[
    H_p = \partial_{ij} f_p = 2 \left(\partial_j x \cdot \partial_i x  + (x-p) \partial_{ij} x \right)
    ,\] 
    where we denoted $\partial_i = \frac{\partial }{\partial u_i}$.
    We will show that $H_p$ is not of full rank if and only if $p$ is a critical value of  
    \[
        E: NV \to  \R^n: (x, v) \mapsto x + v
    ,\] 
    where $NV$ is the normal bundle to $V$ w.r.t.\ the Euclidean metric on $\R^n$.

    First we define a local parametrization of $NV$:
    \[
        (u_1, \ldots, u_d, t_1, \ldots, t_{n-d}) \mapsto \Big(x(u_1, \ldots, u_d), \sum_{i=1}^{n-d} t_i v_i(u_1, \ldots, u_{d})\Big)
    ,\] 
    where the $v_i$ form a local orthonormal basis at each point, normal to $TV$.
\begin{marginfigure}
    \centering
    \incfig{abundance-of-morse-functions-parametrization-of-the-normal-bundle}
    \caption{Parametrization of the normal bundle of $V$.}
    \label{fig:abundance-of-morse-functions-parametrization-of-the-normal-bundle}
\end{marginfigure}
    Then in these coordinates,
    \[
        \partial_i E = \partial_i x  + \sum_{k=1}^{n-d} t_k \partial_i v_k 
        \qquad
        \qquad
        \partial_{t_j} E  = v_j
    .\]
    To see whether these vectors are independent, we compute the inner products with the $n$ independent vectors
    \[
    \partial_1 x , \ldots, \partial_d x , v_1, \ldots, v_{n-d}
    .\] 
    This gives the following matrix with the same rank as $E_*$:
     \[
    \begin{pmatrix}
        (\partial_i x\cdot \partial_j x + \sum_k t_k \partial_iv_{k} \cdot \partial_j x) &  \sum_k \partial_i v_{k} \cdot  v_\ell\\
        0 & \operatorname{Id}
    \end{pmatrix}
    .\] 
    Therefore,\todo{This is wrong? Should be something along the lines of $+ \Rank I$?}
    \[
    \Rank E_* = \Rank \left(\partial_i x\cdot \partial_j x + \sum_k t_k \partial_iv_{k} \cdot \partial_j x\right)  
    .\] 
    Now in the second term, we can move $\partial_i$ from $v_k$ to $x$ and get a minus sign in return:
    \begin{align*}
        \partial_iv_{k} \cdot \partial_j x &= \partial_i (v_k \cdot \partial_j x)  - v_k \cdot  \partial_i \partial_j x\\
                               &= - v_k \cdot  \partial_i \partial_j x
    ,\end{align*} 
    as $v_k \perp \partial_j x$.
    So finally, we have
    \begin{align*}
    \Rank {E_*}_{(x, v)}
        &= \Rank \left(\partial_i x\cdot \partial_j x - \sum_k t_k v_{k} \cdot \partial_i \partial_j x\right)  \\
        &= \Rank \left(\partial_i x\cdot \partial_j x - v \cdot \partial_i \partial_j x\right)  \\
        &= \Rank \left(\partial_i x\cdot \partial_j x + (x-p) \cdot \partial_i \partial_j x\right)  \\
        &= \Rank H_p
    .\end{align*} 
    This concludes the proof.
\end{proof}




\begin{prop}
    Let $V$ be a manifold that can be embedded as a submanifold into a Euclidean space.
    Let $f: V \to  \R$ be a function.
    Let $k$ be an integer.
    Then $f$ and all its derivatives of order $\le k$ can be uniformly
    approximated by Morse functions on every compact subset.
\end{prop}

The idea of the proof goes as follows.
We choose an embedding of $V$ where $f$ is the first coordinate on $V$, so we can think of $f$ as a simple projection: $x \mapsto x_1$.
Then this function can be approximated in the following way:
\[
    x_1 \approx \frac{(x_1+c)^2 - c^2}{2c} \qquad \text{as $c \to  \infty$,}
\]
and even when considering the other dimensions, the approximation still works:
\[
    x_1 \approx \frac{\|x - p\|^2 - c^2}{2c} \qquad \text{with $p = (-c, 0, \ldots, 0)$ and $c\to  \infty$}
.\] 
Note that the right hand side is almost always a Morse function.

\begin{proof}
    Embed $V$ in $\R^{n}$ for $n$ sufficiently large such that $f$ is the first coordinate:
    \[
        h(x) = (f(x), h_2(x), \ldots, h_n(x))
    .\] 
    Let $c \in \R$. For almost every point $p = (-c + \epsilon_1, \epsilon_2, \ldots, \epsilon_n)$, the function
    \[
        g_c(x) = \frac{\|x - p\|^2 - c^2}{2c} 
    \] 
    is Morse.
    Then
    \begin{align*}
        g_c(x) &= \frac{1}{2c}  \sum (x_i - p_i)^2 - c^2\\
             &= \frac{1}{2c} \left((f(x) + c - \epsilon_1 )^2 + (h_2(x) - \epsilon_2)^2 + \cdots + (h_n(x) - \epsilon_n)^2\right)\\
             &= f(x) +  \frac{f(x)^2 + \sum h_i(x)^2}{2c} - \frac{\epsilon_1 f(x)  + \sum \epsilon_i h_i(x)}{c}  + \sum \epsilon_i^2 - \epsilon_1
    .\end{align*} 

    This concludes the proof.
    Indeed, let $K$ be a compact subset of $V$.
    The functions $\frac{d^{j}}{dx^{j}} (f(x)^2 + \sum h_i(x)^2)$ for $j = 1, \ldots,k$ all attain their maximum on $K$, so by choosing $c$ big enough, we can make them simultaneously arbitrarily small in a uniform way. Similarly for the third term.
    Lastly, we can also $\epsilon_i$ arbitrarily small while still retaining that $g$ is a Morse function.
\end{proof}

\begin{figure}
    \centering
    \sidecaption{
        We can approximate any smooth function with a Morse function.
        On the left, we plotted the level sets of $f$ itself.
        Because the coordinates are $f$ and $h_2$, these level sets are vertical planes.
        The two right plots show level sets of $g_c$ for $c=10$ and $c=100$, which are circles.
        We see that $g_c$ approximates $f$ if $c \to  \infty$.
    }
    \incfig{approximate-morse-functions}
    \label{fig:approximate-morse-functions}
\end{figure}


% Smale condition: tilted torus!

% CV:
% seminar
% courses relevant courses
% motivation letter:
% symplectic geometry,
% contact geometry research papers, 
% poisson geometry advanced reading course


% PHD students: Stephane Geudens geometry
% PHD students: Karandeep Singh phd
